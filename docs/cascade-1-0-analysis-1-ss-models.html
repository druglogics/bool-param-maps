<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>CASCADE 1.0 Analysis - 1 ss models | A study in boolean model parameterization</title>
  <meta name="description" content="Investigations related to link operators mutations in boolean models" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="CASCADE 1.0 Analysis - 1 ss models | A study in boolean model parameterization" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bblodfon.github.io/bool-param-maps/" />
  
  <meta property="og:description" content="Investigations related to link operators mutations in boolean models" />
  <meta name="github-repo" content="bblodfon/bool-param-maps" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="CASCADE 1.0 Analysis - 1 ss models | A study in boolean model parameterization" />
  
  <meta name="twitter:description" content="Investigations related to link operators mutations in boolean models" />
  

<meta name="author" content="John Zobolas" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cascade-1-0-parameterization-vs-fixpoints.html"/>
<link rel="next" href="r-session-info.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Sections</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Intro</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-general.html"><a href="cascade-1-0-general.html"><i class="fa fa-check"></i>CASCADE 1.0 - General</a>
<ul>
<li class="chapter" data-level="" data-path="cascade-1-0-general.html"><a href="cascade-1-0-general.html#network-properties"><i class="fa fa-check"></i>Network Properties</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-general.html"><a href="cascade-1-0-general.html#model-stable-state-statistics"><i class="fa fa-check"></i>Model Stable State Statistics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cascade-1-0-parameterization-vs-fixpoints.html"><a href="cascade-1-0-parameterization-vs-fixpoints.html"><i class="fa fa-check"></i>CASCADE 1.0 - Parameterization vs #fixpoints</a>
<ul>
<li class="chapter" data-level="" data-path="cascade-1-0-parameterization-vs-fixpoints.html"><a href="cascade-1-0-parameterization-vs-fixpoints.html#multinomial-lasso"><i class="fa fa-check"></i>Multinomial LASSO</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-parameterization-vs-fixpoints.html"><a href="cascade-1-0-parameterization-vs-fixpoints.html#random-forests"><i class="fa fa-check"></i>Random Forests</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-parameterization-vs-fixpoints.html"><a href="cascade-1-0-parameterization-vs-fixpoints.html#parameterization-maps"><i class="fa fa-check"></i>Parameterization Maps</a>
<ul>
<li class="chapter" data-level="" data-path="cascade-1-0-parameterization-vs-fixpoints.html"><a href="cascade-1-0-parameterization-vs-fixpoints.html#unsupervised-umap"><i class="fa fa-check"></i>Unsupervised UMAP</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-parameterization-vs-fixpoints.html"><a href="cascade-1-0-parameterization-vs-fixpoints.html#supervised-umap"><i class="fa fa-check"></i>Supervised UMAP</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cascade-1-0-parameterization-vs-fixpoints.html"><a href="cascade-1-0-parameterization-vs-fixpoints.html#embedding-important-nodes-in-the-map"><i class="fa fa-check"></i>Embedding Important Nodes in the Map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html"><i class="fa fa-check"></i>CASCADE 1.0 Analysis - 1 ss models</a>
<ul>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#stable-states-data"><i class="fa fa-check"></i>Stable States Data</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#parameterization-maps-1"><i class="fa fa-check"></i>Parameterization Maps</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#gitsbe-models-on-the-map"><i class="fa fa-check"></i>Gitsbe Models on the Map</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#performance-maps"><i class="fa fa-check"></i>Performance Maps</a>
<ul>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#unsupervised-umap-1"><i class="fa fa-check"></i>Unsupervised UMAP</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#supervised-umap-1"><i class="fa fa-check"></i>Supervised UMAP</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#performance-vs-fitness"><i class="fa fa-check"></i>Performance vs Fitness</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#fitness-maps"><i class="fa fa-check"></i>Fitness Maps</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#performance-biomarkers"><i class="fa fa-check"></i>Performance biomarkers</a>
<ul>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#emba-biomarkers"><i class="fa fa-check"></i>emba biomarkers</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#random-forest-biomarkers"><i class="fa fa-check"></i>Random Forest biomarkers</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#emba-vs-rf-results"><i class="fa fa-check"></i>emba vs RF Results</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#embedding-link-operator-biomarkers-in-the-map"><i class="fa fa-check"></i>Embedding Link Operator Biomarkers in the Map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#synergy-maps"><i class="fa fa-check"></i>Synergy Maps</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#stable-state-patterns-in-synergistic-models"><i class="fa fa-check"></i>Stable State Patterns in Synergistic models</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#synergy-biomarkers"><i class="fa fa-check"></i>Synergy Biomarkers</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-session-info.html"><a href="r-session-info.html"><i class="fa fa-check"></i>R session info</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A study in boolean model parameterization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cascade-1.0-analysis---1-ss-models" class="section level1 unnumbered" number="">
<h1>CASCADE 1.0 Analysis - 1 ss models</h1>
<div id="stable-states-data" class="section level2 unnumbered" number="">
<h2>Stable States Data</h2>
<div class="note">
<p>In this section, <strong>only the boolean models that have 1 stable state</strong> will be used in the analysis.
All variables of interest (stable state, link-operator parameterization, fitness to steady state, performance MCC score, etc.) will relate only to the 1 stable state models from now on.</p>
<p>To load the stable state data for the models that have <strong>1 stable state</strong> use the Zenodo dataset <a href="https://doi.org/10.5281/zenodo.4022783"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.4022783.svg" alt="DOI" /></a> and the script <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/get_ss_data.R">get_ss_data.R</a></p>
</div>
</div>
<div id="parameterization-maps-1" class="section level2 unnumbered" number="">
<h2>Parameterization Maps</h2>
<p>In this section we present the results of using UMAP <span class="citation">(McInnes, Healy, and Melville <a href="references.html#ref-McInnes2018a" role="doc-biblioref">2018</a>)</span> on the link-operator parameterization data of the CASCADE 1.0 models with 1 stable state.
We created several such <em>parameterization maps</em> by adjusting the <em>n_neighbors</em> parameter input (from <span class="math inline">\(2\)</span> to <span class="math inline">\(20\)</span>), which is responsible for the <strong>size of the local neighborhood</strong> (in terms of number of neighboring sample points) used for the manifold approximation.
As the documentation says, larger values result in <strong>more global views</strong> of the manifold, while smaller values result in <strong>more local data</strong> being preserved.
To get these map images and the reduced dimension dataset, use the script <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/1ss_models_umap.R">1ss_models_umap.R</a> for more details.</p>
<div class="blue-box">
<p>Note that in all these mappings to the 2D space, <strong>models that share similar link-operator parameterization will reside in the same area/cluster in the map</strong>.
The larger the <em>n_neighbors</em> is, the more the smaller clusters merge into larger ones.
The images for <span class="math inline">\(\ge 14\)</span> <em>n_neighbors</em> are almost exactly the same.</p>
</div>
<p>We present some of these maps below:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb23-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/1ss_umap/1ss_umap_unsup_2.png&quot;</span>)</span>
<span id="cb23-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb23-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/1ss_umap/1ss_umap_unsup_3.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:param-maps-1ss-models-1"></span>
<img src="img/1ss_umap/1ss_umap_unsup_2.png" alt="2D Parameterization map for 1 stable state models (2 and 3 neighbors)" width="50%" /><img src="img/1ss_umap/1ss_umap_unsup_3.png" alt="2D Parameterization map for 1 stable state models (2 and 3 neighbors)" width="50%" />
<p class="caption">
Figure 13: 2D Parameterization map for 1 stable state models (2 and 3 neighbors)
</p>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb24-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/1ss_umap/1ss_umap_unsup_5.png&quot;</span>)</span>
<span id="cb24-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb24-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/1ss_umap/1ss_umap_unsup_6.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:param-maps-1ss-models-2"></span>
<img src="img/1ss_umap/1ss_umap_unsup_5.png" alt="2D Parameterization map for 1 stable state models (5 and 6 neighbors)" width="50%" /><img src="img/1ss_umap/1ss_umap_unsup_6.png" alt="2D Parameterization map for 1 stable state models (5 and 6 neighbors)" width="50%" />
<p class="caption">
Figure 14: 2D Parameterization map for 1 stable state models (5 and 6 neighbors)
</p>
</div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb25-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/1ss_umap/1ss_umap_unsup_8.png&quot;</span>)</span>
<span id="cb25-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb25-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/1ss_umap/1ss_umap_unsup_11.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:param-maps-1ss-models-3"></span>
<img src="img/1ss_umap/1ss_umap_unsup_8.png" alt="2D Parameterization map for 1 stable state models (8 and 11 neighbors)" width="50%" /><img src="img/1ss_umap/1ss_umap_unsup_11.png" alt="2D Parameterization map for 1 stable state models (8 and 11 neighbors)" width="50%" />
<p class="caption">
Figure 15: 2D Parameterization map for 1 stable state models (8 and 11 neighbors)
</p>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb26-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/1ss_umap/1ss_umap_unsup_12.png&quot;</span>)</span>
<span id="cb26-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb26-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/1ss_umap/1ss_umap_unsup_15.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:param-maps-1ss-models-4"></span>
<img src="img/1ss_umap/1ss_umap_unsup_12.png" alt="2D Parameterization map for 1 stable state models (12 and 15 neighbors)" width="50%" /><img src="img/1ss_umap/1ss_umap_unsup_15.png" alt="2D Parameterization map for 1 stable state models (12 and 15 neighbors)" width="50%" />
<p class="caption">
Figure 16: 2D Parameterization map for 1 stable state models (12 and 15 neighbors)
</p>
</div>
<div class="green-box">
<p>We observe the existence of <strong>two large families (superclusters) of parameterization models</strong>, especially for more <em>global</em> views of the dataset (<span class="math inline">\(\text{n_neighbors}\ge 8\)</span>).</p>
<p><strong>Distinct smaller sub-clusters of closely parameterized models</strong> also manifest for different number of neighbors, which suggests that there is some order in the parameterization of the 1 stable state models (as exemplified by the UMAP method) across multiple visualization scales.</p>
</div>
</div>
<div id="gitsbe-models-on-the-map" class="section level2 unnumbered" number="">
<h2>Gitsbe Models on the Map</h2>
<p><a href="https://druglogics.github.io/druglogics-doc/gitsbe.html">Gitsbe</a> uses a genetic algorithm approach to produce boolean models that are fitted to activity-based, biomarker training data.</p>
<p>We used Gitsbe and tested the produced models performance (ensemble-wise drug combination predictions) against synergy data from <span class="citation">(Flobak et al. <a href="references.html#ref-Flobak2015" role="doc-biblioref">2015</a>)</span> in <a href="https://bblodfon.github.io/ags-paper-1/cascade-1-0-analysis.html">another report</a>.
The calibrated models performed very well in terms of both ROC and PR-AUC.</p>
<div class="blue-box">
<p>Here we want to check whether models produced by a method such as a genetic algorithm-based one <strong>have similar parameterization</strong> - i.e. they belong in the same neighborhood in the parameterization map.</p>
</div>
<p>We will use models from <span class="math inline">\(1000\)</span> gitsbe simulations, calibrated to steady state (a total of <span class="math inline">\(3000\)</span> models, choosing the <span class="math inline">\(3\)</span> best-fit models from each simulation).
The results are provided in <a href="https://github.com/bblodfon/bool-param-maps/blob/master/data/cascade_1.0_ss_1000sim_fixpoints_hsa.tar.gz">this data file</a> and to reproduce them, follow the instructions <a href="https://bblodfon.github.io/ags-paper-1/reproduce-data-simulation-results.html">here</a>, keeping the default configuration options for CASCADE 1.0 and changing only the number of simulations to <span class="math inline">\(1000\)</span>).</p>
<p>All the Gitsbe models had a large fitness to the steady state AGS data (their stable states fitting almost exactly the states of the manually-curated 24 nodes), as it can be seen from the next figure (see <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/gitsbe_models_fit.R">gitsbe_models_fit.R</a>):</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb27-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/gitsbe_fit_density.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:gitbse-fit-fig"></span>
<img src="img/gitsbe_fit_density.png" alt="Gitsbe model fitness to AGS steady state" width="1050" />
<p class="caption">
Figure 17: Gitsbe model fitness to AGS steady state
</p>
</div>
<p>To generate the next figures (same map, same gitsbe models, different number of neighbors) use the <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/gitsbe_model_embedding.R">gitsbe_model_embedding.R</a> - all figures are available <a href="https://github.com/bblodfon/bool-param-maps/tree/master/img/gitsbe_umaps">here</a>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb28-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/gitsbe_umaps/2nn.png&quot;</span>)</span>
<span id="cb28-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb28-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/gitsbe_umaps/4nn.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:gitsbe-maps-1"></span>
<img src="img/gitsbe_umaps/2nn.png" alt="Gitsbe models in Parameterization map (2 and 4 neighbors)" width="50%" /><img src="img/gitsbe_umaps/4nn.png" alt="Gitsbe models in Parameterization map (2 and 4 neighbors)" width="50%" />
<p class="caption">
Figure 18: Gitsbe models in Parameterization map (2 and 4 neighbors)
</p>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb29-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/gitsbe_umaps/8nn.png&quot;</span>)</span>
<span id="cb29-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb29-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/gitsbe_umaps/14nn.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:gitsbe-maps-2"></span>
<img src="img/gitsbe_umaps/8nn.png" alt="Gitsbe models in Parameterization map (6 and 8 neighbors)" width="50%" /><img src="img/gitsbe_umaps/14nn.png" alt="Gitsbe models in Parameterization map (6 and 8 neighbors)" width="50%" />
<p class="caption">
Figure 19: Gitsbe models in Parameterization map (6 and 8 neighbors)
</p>
</div>
<div class="green-box">
<p>Gitsbe-generated models that fit the biomarker steady state data for the AGS cell line have a <strong>diverse structure that spans across the parameterization map</strong> but nonetheless appear to gather in <strong>smaller parameterization-specific sub-clusters</strong> (better seen in the Figure with 14 neighbors which gives a more global view of the dataset).</p>
<p>Observing the distribution of the gitsbe models in the parameterization map, we see that most of them are being <strong>placed at one of the two superclusters</strong>.</p>
</div>
<p>Of course, there are areas in the map that Gitsbe models do not cover, which may as well be high-performance model areas.
Since we have generated all possible link-operator models with CASCADE 1.0, we can proceed to generate a performance map (atop the parameterization one) and cross-check if the gitsbe models fall into high-performance areas or not.</p>
</div>
<div id="performance-maps" class="section level2 unnumbered" number="">
<h2>Performance Maps</h2>
<p>Every model generated via <code>abmlog</code> (<a href="cascade-1-0-general.html#model-stable-state-statistics">Model Stable State Statistics</a>) was tested against the synergy dataset of <span class="citation">(Flobak et al. <a href="references.html#ref-Flobak2015" role="doc-biblioref">2015</a>)</span>.
Among <span class="math inline">\(21\)</span> drug combinations, <span class="math inline">\(4\)</span> were found synergistic in that dataset, namely:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb30-1"></a>obs_syn =<span class="st"> </span>emba<span class="op">::</span><span class="kw">get_observed_synergies</span>(<span class="dt">file =</span> <span class="st">&quot;data/observed_synergies_cascade_1.0&quot;</span>)</span>
<span id="cb30-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb30-2"></a>usefun<span class="op">::</span><span class="kw">pretty_print_vector_values</span>(obs_syn, <span class="dt">vector.values.str =</span> <span class="st">&quot;synergies&quot;</span>)</span></code></pre></div>
<blockquote>
<p>4 synergies: PI-PD, PI-5Z, PD-AK, AK-5Z</p>
</blockquote>
<div class="blue-box">
<p>Using the <a href="https://druglogics.github.io/druglogics-doc/drabme.html">drabme</a> software module, we tested every CASCADE 1.0 model against this dataset and got each model’s predictions for each drug combination.
The <em>HSA</em> rule was used to define if a model is synergistic for a particular combination.
The results are available in the Zenodo dataset <a href="https://doi.org/10.5281/zenodo.4022783"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.4022783.svg" alt="DOI" /></a>, file <code>cascade_1.0_hsa_fixpoints.tar.gz</code>.
As previously said, we are going to use the 1 stable state model predictions only.</p>
</div>
<p>We used the emba R package <span class="citation">(Zobolas, Kuiper, and Flobak <a href="references.html#ref-Zobolas2020" role="doc-biblioref">2020</a>)</span> to perform a biomarker analysis on the 1 stable state models dataset and their predictions from <code>drabme</code> (see script <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/emba_analysis.R">emba_analysis.R</a>).
Part of the results from the emba analysis is the calculation of the <strong>Matthews correlation coefficient (MCC) performance score</strong> for each model.
We use these MCC model scores to draw the next figures (see <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/mcc_figures.R">mcc_figures.R</a> script)</p>
<p>Splitting all the 1 stable state models to <span class="math inline">\(4\)</span> MCC classes we can see that <strong>a lot of models have performance close to random prediction or even worse</strong>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb31-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_hist.png&quot;</span>)</span>
<span id="cb31-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb31-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_hist2.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:mcc-histogram"></span>
<img src="img/mcc_hist.png" alt="MCC Classes Histograms" width="50%" /><img src="img/mcc_hist2.png" alt="MCC Classes Histograms" width="50%" />
<p class="caption">
Figure 20: MCC Classes Histograms
</p>
</div>
<div class="green-box">
<p>Most of the 1 stable state models have MCC performance close to random or worse, making it thus difficult for any algorithm to find the <em>best</em> performance models (i.e. the 3-4th MCC class models, which amounts to only <span class="math inline">\(5\%\)</span> of the total number of models with 1 stable state, given the standardized boolean equation parameterization inspired by <span class="citation">(Mendoza and Xenarios <a href="references.html#ref-Mendoza2006" role="doc-biblioref">2006</a>)</span>).</p>
</div>
<div id="unsupervised-umap-1" class="section level3 unnumbered" number="">
<h3>Unsupervised UMAP</h3>
<p>If we draw the parameterization maps for different number of neighbors and <strong>color the points/models according to their MCC score</strong>, we get these images (to see all figures, check <a href="https://github.com/bblodfon/bool-param-maps/tree/master/img/mcc_maps">here</a>):</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb32-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_maps/2nn.png&quot;</span>)</span>
<span id="cb32-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb32-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_maps/14nn.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:mcc-maps-1"></span>
<img src="img/mcc_maps/2nn.png" alt="MCC Parameterization map (2 and 14 neighbors)" width="50%" /><img src="img/mcc_maps/14nn.png" alt="MCC Parameterization map (2 and 14 neighbors)" width="50%" />
<p class="caption">
Figure 21: MCC Parameterization map (2 and 14 neighbors)
</p>
</div>
<div class="green-box">
<p>We observe that the two large parameterization superclusters (especially outlined by the figures with <span class="math inline">\(2\)</span> and <span class="math inline">\(\ge 8\)</span> neighbors) are closely related with the MCC performance metric.
Specifically, these <strong>2 superclusters dichotomize the models performance landscape</strong> into 2 areas, where only one of them has the majority of good performance models (i.e. those that have an MCC score <span class="math inline">\(&gt;0\)</span>).</p>
<p>Also, we observe that closely parameterized models tend to have same performance (<strong>existence of smaller parameterization clusters of same performance models</strong>).</p>
</div>
<div class="orange-box">
<p>Comparing the corresponding <strong>Gitsbe parameterization maps with the MCC maps</strong>, we can clearly verify now that the Gitsbe models <strong>might not always be the best performing ones</strong> (in terms of MCC score) since they appear in both superclusters (and that’s only a first-fine measure for determining performance based on structure) - but at least they <strong>tend to be more in the higher performance supercluster</strong>.</p>
<p>Reasons why the gitsbe models are not always on the high-performance supercluster can be justified by:</p>
<ul>
<li>The nature of the genetic algorithm, which is a <em>heuristic</em> method and as such produces <em>local</em> optima</li>
<li>The training dataset does not provide enough <em>constraints</em> for the optimization problem, i.e. more steady state nodes are needed to be fitted in the models stable state which will result in models with more strict parameterization patterns</li>
<li>A combination of the two above</li>
</ul>
</div>
</div>
<div id="supervised-umap-1" class="section level3 unnumbered" number="">
<h3>Supervised UMAP</h3>
<div class="blue-box">
<p>We perform <strong>supervised dimension reduction</strong> using UMAP on the 1 stable state model dataset.
The only difference with the previous performance maps is that we provide UMAP (as an input) the information of the models performance (the MCC score) and not just overlay it (via coloring) afterwards.</p>
<p>The main thing we want to answer here is <strong>if UMAP can do a better job placing the models on the map</strong>, given additional information about their performance.</p>
</div>
<p>We tried UMAP with different <em>number of neighbors</em> (from local to a more global view of the dataset), <em>target weight</em> (weighting factor between data topology (<span class="math inline">\(0\)</span>) and target/response topology (<span class="math inline">\(1\)</span>) or somewhere in between) and setting the response either to the MCC score as a continuous, numeric value or to the MCC classes (discrete variable) as <a href="cascade-1-0-analysis-1-ss-models.html#fig:mcc-histogram">shown above</a>.
See script <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/mcc_sumap.R">mcc_sumap.R</a> for more details.</p>
<p>First, we show some maps, where the response <strong>MCC was treated as a continuous variable</strong>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb33-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/4nn_0w.png&quot;</span>)</span>
<span id="cb33-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb33-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/4nn_0.5w.png&quot;</span>)</span>
<span id="cb33-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb33-3"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/4nn_1w.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:mcc-sumaps-1"></span>
<img src="img/mcc_sumaps/4nn_0w.png" alt="MCC Parameterization map (4 neighbors, MCC continuous)" width="33%" /><img src="img/mcc_sumaps/4nn_0.5w.png" alt="MCC Parameterization map (4 neighbors, MCC continuous)" width="33%" /><img src="img/mcc_sumaps/4nn_1w.png" alt="MCC Parameterization map (4 neighbors, MCC continuous)" width="33%" />
<p class="caption">
Figure 22: MCC Parameterization map (4 neighbors, MCC continuous)
</p>
</div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb34-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/14nn_0.5w.png&quot;</span>)</span>
<span id="cb34-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb34-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/14nn_1w.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:mcc-sumaps-2"></span>
<img src="img/mcc_sumaps/14nn_0.5w.png" alt="MCC Parameterization map (14 neighbors, MCC continuous)" width="50%" /><img src="img/mcc_sumaps/14nn_1w.png" alt="MCC Parameterization map (14 neighbors, MCC continuous)" width="50%" />
<p class="caption">
Figure 23: MCC Parameterization map (14 neighbors, MCC continuous)
</p>
</div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb35-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/20nn_0.5w.png&quot;</span>)</span>
<span id="cb35-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb35-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/20nn_1w.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:mcc-sumaps-3"></span>
<img src="img/mcc_sumaps/20nn_0.5w.png" alt="MCC Parameterization map (20 neighbors, MCC continuous)" width="50%" /><img src="img/mcc_sumaps/20nn_1w.png" alt="MCC Parameterization map (20 neighbors, MCC continuous)" width="50%" />
<p class="caption">
Figure 24: MCC Parameterization map (20 neighbors, MCC continuous)
</p>
</div>
<div class="green-box">
<p>Very artistic and knotty figures!
UMAP achieves some sort of distinction between the different MCC values, especially when the topology is heavily based on the response MCC value (<em>target weight</em> is <span class="math inline">\(1\)</span>)</p>
</div>
<p>Next, we show some maps, where the response <strong>MCC was treated as a categorical variable</strong>, denoting the MCC class the models belong to (higher the better):</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb36-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/class/4nn_0.5w_class.png&quot;</span>)</span>
<span id="cb36-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb36-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/class/6nn_0.5w_class.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:mcc-sumaps-4"></span>
<img src="img/mcc_sumaps/class/4nn_0.5w_class.png" alt="MCC Parameterization map (4 and 6 neighbors, MCC Classes)" width="50%" /><img src="img/mcc_sumaps/class/6nn_0.5w_class.png" alt="MCC Parameterization map (4 and 6 neighbors, MCC Classes)" width="50%" />
<p class="caption">
Figure 25: MCC Parameterization map (4 and 6 neighbors, MCC Classes)
</p>
</div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb37-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/class/8nn_0.5w_class.png&quot;</span>)</span>
<span id="cb37-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb37-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/class/10nn_0.5w_class.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:mcc-sumaps-5"></span>
<img src="img/mcc_sumaps/class/8nn_0.5w_class.png" alt="MCC Parameterization map (8 and 10 neighbors, MCC Classes)" width="50%" /><img src="img/mcc_sumaps/class/10nn_0.5w_class.png" alt="MCC Parameterization map (8 and 10 neighbors, MCC Classes)" width="50%" />
<p class="caption">
Figure 26: MCC Parameterization map (8 and 10 neighbors, MCC Classes)
</p>
</div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb38-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/class/14nn_0w_class.png&quot;</span>)</span>
<span id="cb38-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb38-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/class/14nn_0.5w_class.png&quot;</span>)</span>
<span id="cb38-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb38-3"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_sumaps/class/14nn_1w_class.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:mcc-sumaps-6"></span>
<img src="img/mcc_sumaps/class/14nn_0w_class.png" alt="MCC Parameterization map (14 neighbors, MCC Classes)" width="33%" /><img src="img/mcc_sumaps/class/14nn_0.5w_class.png" alt="MCC Parameterization map (14 neighbors, MCC Classes)" width="33%" /><img src="img/mcc_sumaps/class/14nn_1w_class.png" alt="MCC Parameterization map (14 neighbors, MCC Classes)" width="33%" />
<p class="caption">
Figure 27: MCC Parameterization map (14 neighbors, MCC Classes)
</p>
</div>
<div class="green-box">
<p>We observe that the higher the number of neighbors is (<span class="math inline">\(\ge 10\)</span> with a balanced <em>target weight</em> of <span class="math inline">\(0.5\)</span>), the better UMAP classifies the models to distinct (super-) clusters representing the different MCC classes.</p>
</div>
</div>
</div>
<div id="performance-vs-fitness" class="section level2 unnumbered" number="">
<h2>Performance vs Fitness</h2>
<div class="blue-box">
<p>We try to see if there is any correlation between <strong>performance (MCC)</strong> and <strong>fitness to the AGS steady state</strong>.</p>
<p>We study <strong>two AGS steady states</strong>: one with a total of <span class="math inline">\(24\)</span> nodes which is the result of manual literature curation (S4 Table in <span class="citation">Flobak et al. (<a href="references.html#ref-Flobak2015" role="doc-biblioref">2015</a>)</span>) and serves as the <em>gold-standard</em>, and one with all <span class="math inline">\(77\)</span> nodes, which is the single (and only) fixpoint of the AGS boolean model in <span class="citation">Flobak et al. (<a href="references.html#ref-Flobak2015" role="doc-biblioref">2015</a>)</span>.</p>
<p>Note that second, larger steady state reports the same activity values for the common <span class="math inline">\(24\)</span> nodes as the first one.</p>
<p>Use the <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/fit_figures.R">fit_figures.R</a> script to reproduce the figures for the literature-curated steady state and the <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/fit_vs_performance_ags_pub.R">fit_vs_performance_ags_pub.R</a> for the AGS model fixpoint/steady state.</p>
</div>
<p>First, we check if the fitness density of all 1 stable state models covers the whole <em>fitness spectrum</em>:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb39-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/1ss_models_fit_density.png&quot;</span>)</span>
<span id="cb39-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb39-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/1ss_models_fit_density_pub.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:1ss-models-fit-density-fig"></span>
<img src="img/1ss_models_fit_density.png" alt="All 1 stable state models fitness to AGS steady state(s)" width="50%" /><img src="img/1ss_models_fit_density_pub.png" alt="All 1 stable state models fitness to AGS steady state(s)" width="50%" />
<p class="caption">
Figure 28: All 1 stable state models fitness to AGS steady state(s)
</p>
</div>
<p>The Pearson correlation between the two fitness vectors is high:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb40-1"></a>fit_data =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/fit_data.rds&quot;</span>)</span>
<span id="cb40-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb40-2"></a>fit_data_pub =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/fit_data_pub.rds&quot;</span>)</span>
<span id="cb40-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb40-3"></a></span>
<span id="cb40-4"><a href="cascade-1-0-analysis-1-ss-models.html#cb40-4"></a><span class="co"># data check</span></span>
<span id="cb40-5"><a href="cascade-1-0-analysis-1-ss-models.html#cb40-5"></a><span class="kw">stopifnot</span>(<span class="kw">all</span>(<span class="kw">names</span>(fit_data) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(fit_data_pub)))</span>
<span id="cb40-6"><a href="cascade-1-0-analysis-1-ss-models.html#cb40-6"></a></span>
<span id="cb40-7"><a href="cascade-1-0-analysis-1-ss-models.html#cb40-7"></a><span class="co"># Pearson correlation</span></span>
<span id="cb40-8"><a href="cascade-1-0-analysis-1-ss-models.html#cb40-8"></a><span class="kw">cor</span>(<span class="dt">x =</span> fit_data, <span class="dt">y =</span> fit_data_pub, <span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>[1] 0.94</p>
<div class="green-box">
<p>We observe that <strong>most of the models have at least half of the nodes</strong> in the same state as in the AGS steady state, no matter which steady state we fit the stable state data against.
This makes the <strong>fitness score distribution skewed</strong> towards the higher fitness values.</p>
<p>Of course, though the two steady states completely agree on the values of the <span class="math inline">\(24\)</span> nodes, it might be that the rest of the nodes have slightly different activity state values from the ones found in the fixpoint attractor of the AGS model in <span class="citation">Flobak et al. (<a href="references.html#ref-Flobak2015" role="doc-biblioref">2015</a>)</span>.
If that is the case in reality, the fitness distribution might be more uniform.</p>
</div>
<p>We follow the same classification scheme as <a href="cascade-1-0-analysis-1-ss-models.html#fig:mcc-histogram">above</a>, i.e. splitting the 1 stable models to <span class="math inline">\(4\)</span> MCC classes and comparing the fitness scores between these classes:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb41-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_vs_fit.png&quot;</span>)</span>
<span id="cb41-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb41-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/mcc_vs_fit_pub.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:fit-vs-perf-fig"></span>
<img src="img/mcc_vs_fit.png" alt="MCC performance vs Fitness to AGS steady state(s) for all 1 stable state models. Left is fitness to the AGS-curated steady state (24 nodes), right is for the full, 77-node steady state." width="50%" /><img src="img/mcc_vs_fit_pub.png" alt="MCC performance vs Fitness to AGS steady state(s) for all 1 stable state models. Left is fitness to the AGS-curated steady state (24 nodes), right is for the full, 77-node steady state." width="50%" />
<p class="caption">
Figure 29: MCC performance vs Fitness to AGS steady state(s) for all 1 stable state models. Left is fitness to the AGS-curated steady state (24 nodes), right is for the full, 77-node steady state.
</p>
</div>
<div class="green-box">
<p>The last MCC class has a <strong>statistically significant higher median fitness</strong> to the AGS steady state compared to all other lower MCC classes, even though the correlation between fitness and performance is not linear and most of the models have a fitness higher than <span class="math inline">\(0.5\)</span>.
Note also that models that have significantly lower than <span class="math inline">\(0.5\)</span> fitness in each steady state case, belong to the first two, lower performance classes.</p>
<p>The last two figures points us to the fact that more constraints are needed for the fitness calculation of the Gitsbe genetic algorithm or any other for that matter (i.e. more literature-curated nodes in the AGS steady state - now only <span class="math inline">\(24/77=31\%\)</span> is included) in order to define more restrictive parameterized models that would allow a much more <em>uniform</em> fitness density spectrum (or at least <strong>not skewed towards the higher fitness values</strong>).
Such fitness spectrum would (hopefully) allow for more granularity in the corresponding performance behavior between the different MCC classes, and thus more distinctive correlation.</p>
</div>
</div>
<div id="fitness-maps" class="section level2 unnumbered" number="">
<h2>Fitness Maps</h2>
<p>If we draw the parameterization maps for different number of neighbors and <strong>color the points/models according to their fitness to the AGS steady state (24 nodes)</strong>, we get these images (see <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/fit_figures.R">fit_figures.R</a> script):</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb42-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/fit_maps/2nn.png&quot;</span>)</span>
<span id="cb42-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb42-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/fit_maps/4nn.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:fit-maps-1"></span>
<img src="img/fit_maps/2nn.png" alt="Fitness Parameterization map (2 and 4 neighbors)" width="50%" /><img src="img/fit_maps/4nn.png" alt="Fitness Parameterization map (2 and 4 neighbors)" width="50%" />
<p class="caption">
Figure 30: Fitness Parameterization map (2 and 4 neighbors)
</p>
</div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb43-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/fit_maps/11nn.png&quot;</span>)</span>
<span id="cb43-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb43-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/fit_maps/14nn.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:fit-maps-2"></span>
<img src="img/fit_maps/11nn.png" alt="Fitness Parameterization map (11 and 14 neighbors)" width="50%" /><img src="img/fit_maps/14nn.png" alt="Fitness Parameterization map (11 and 14 neighbors)" width="50%" />
<p class="caption">
Figure 31: Fitness Parameterization map (11 and 14 neighbors)
</p>
</div>
<div class="green-box">
<p>Higher fitness models manifest in both superclusters, suggesting again the need for more literature-curated nodes in the training data (AGS steady state).
Also, closely parameterized models tend to have same fitness (<strong>existence of smaller parameterization clusters of same fitness models</strong>).</p>
<p>No apparent correlation can be observed between fitness and performance (MCC) maps.</p>
</div>
</div>
<div id="performance-biomarkers" class="section level2 unnumbered" number="">
<h2>Performance biomarkers</h2>
<div class="blue-box">
<p>We assess <strong>important nodes (biomarkers)</strong> whose <em>activity</em> and/or link-operator (<em>parameterization</em>) affects the models performance in terms of the achieved MCC score.</p>
</div>
<div id="emba-biomarkers" class="section level3 unnumbered" number="">
<h3>emba biomarkers</h3>
<p>We use the <code>emba</code> results with <span class="math inline">\(4\)</span> MCC classes (see script <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/emba_analysis.R">emba_analysis.R</a> and MCC classification histograms <a href="cascade-1-0-analysis-1-ss-models.html#fig:mcc-histogram">above</a>).
What emba <span class="citation">(Zobolas, Kuiper, and Flobak <a href="references.html#ref-Zobolas2020" role="doc-biblioref">2020</a>)</span> does is to group the models to <span class="math inline">\(4\)</span> MCC Classes and compare the average stable state activities and link operator values for each node between <strong>every possible pair of MCC classes</strong>.
Nodes that have <strong>higher average differences</strong> (either positively or negatively and between any comparison pair) are considered as <strong>more important</strong> and are thus annotated as <em>biomarkers</em> based on a given threshold.</p>
<p>In the next heatmap, a positive (resp. negative) state difference for a node denotes that its activity value was larger (resp. lower) in the higher MCC class of the corresponding comparison pair:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-1"></a>mcc_res =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/emba_mcc_res/mcc_4_res.rds&quot;</span>)</span>
<span id="cb44-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-2"></a></span>
<span id="cb44-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-3"></a><span class="co"># color some important nodes and lower the threshold</span></span>
<span id="cb44-4"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-4"></a>activity_biomarkers =<span class="st"> </span>emba<span class="op">::</span><span class="kw">get_biomarkers</span>(mcc_res<span class="op">$</span>diff.state.mcc.mat, <span class="dt">threshold =</span> <span class="fl">0.48</span>)</span>
<span id="cb44-5"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-5"></a></span>
<span id="cb44-6"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-6"></a>imp_nodes_colors =<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="kw">ncol</span>(mcc_res<span class="op">$</span>diff.state.mcc.mat))</span>
<span id="cb44-7"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-7"></a><span class="kw">names</span>(imp_nodes_colors) =<span class="st"> </span><span class="kw">colnames</span>(mcc_res<span class="op">$</span>diff.state.mcc.mat)</span>
<span id="cb44-8"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-8"></a>imp_nodes_colors[<span class="kw">names</span>(imp_nodes_colors) <span class="op">%in%</span><span class="st"> </span>activity_biomarkers<span class="op">$</span>biomarkers.pos] =<span class="st"> &quot;green4&quot;</span></span>
<span id="cb44-9"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-9"></a>imp_nodes_colors[<span class="kw">names</span>(imp_nodes_colors) <span class="op">%in%</span><span class="st"> </span>activity_biomarkers<span class="op">$</span>biomarkers.neg] =<span class="st"> &quot;red4&quot;</span></span>
<span id="cb44-10"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-10"></a></span>
<span id="cb44-11"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-11"></a><span class="co"># define coloring function of state differences</span></span>
<span id="cb44-12"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-12"></a>col_fun =<span class="st"> </span>circlize<span class="op">::</span><span class="kw">colorRamp2</span>(<span class="kw">c</span>(<span class="kw">min</span>(mcc_res<span class="op">$</span>diff.state.mcc.mat), <span class="dv">0</span>, <span class="kw">max</span>(mcc_res<span class="op">$</span>diff.state.mcc.mat)), </span>
<span id="cb44-13"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-13"></a>  <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;green&quot;</span>))</span>
<span id="cb44-14"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-14"></a></span>
<span id="cb44-15"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-15"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb44-16"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-16"></a>state_heat =<span class="st"> </span>ComplexHeatmap<span class="op">::</span><span class="kw">Heatmap</span>(<span class="dt">matrix =</span> mcc_res<span class="op">$</span>diff.state.mcc.mat, </span>
<span id="cb44-17"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-17"></a>  <span class="dt">name =</span> <span class="st">&quot;State Difference&quot;</span>, <span class="dt">col =</span> col_fun,</span>
<span id="cb44-18"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-18"></a>  <span class="dt">row_title =</span> <span class="st">&quot;MCC Classes Pairs&quot;</span>, <span class="dt">row_names_side =</span> <span class="st">&quot;left&quot;</span>, </span>
<span id="cb44-19"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-19"></a>  <span class="dt">row_title_side =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">row_dend_side =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb44-20"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-20"></a>  <span class="dt">column_title =</span> <span class="st">&quot;Average State Differences between MCC Classes&quot;</span>, </span>
<span id="cb44-21"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-21"></a>  <span class="dt">column_names_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">6</span>, <span class="dt">col =</span> imp_nodes_colors),</span>
<span id="cb44-22"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-22"></a>  <span class="dt">heatmap_legend_param =</span> <span class="kw">list</span>(<span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>))</span>
<span id="cb44-23"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-23"></a></span>
<span id="cb44-24"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-24"></a>biomarkers_legend =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">title =</span> <span class="st">&quot;Activity State Biomarkers&quot;</span>,</span>
<span id="cb44-25"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-25"></a>  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Inhibited&quot;</span>),</span>
<span id="cb44-26"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-26"></a>  <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;green4&quot;</span>, <span class="st">&quot;red4&quot;</span>)))</span>
<span id="cb44-27"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-27"></a></span>
<span id="cb44-28"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-28"></a><span class="kw">draw</span>(state_heat, <span class="dt">annotation_legend_list =</span> biomarkers_legend, </span>
<span id="cb44-29"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-29"></a>  <span class="dt">heatmap_legend_side =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">annotation_legend_side =</span> <span class="st">&quot;bottom&quot;</span>, </span>
<span id="cb44-30"><a href="cascade-1-0-analysis-1-ss-models.html#cb44-30"></a>  <span class="dt">merge_legend =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:emba-activity-biomarkers"></span>
<img src="index_files/figure-html/emba-activity-biomarkers-1.png" alt="Heatmap of Average State Differences (emba, 4 MCC Classes)" width="672" />
<p class="caption">
Figure 32: Heatmap of Average State Differences (emba, 4 MCC Classes)
</p>
</div>
<p>So, the following nodes are identified as <em>active</em> biomarkers (they tend to be active in the higher performance models):</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb45-1"></a>usefun<span class="op">::</span><span class="kw">pretty_print_vector_values</span>(activity_biomarkers<span class="op">$</span>biomarkers.pos)</span></code></pre></div>
<blockquote>
<p>7 nodes: MAP3K7, GRAP2, MAP2K7, MAP2K3, TAB_f, ERK_f, NLK</p>
</blockquote>
<p>and the following as <em>inhibited</em> biomarkers:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb46-1"></a>usefun<span class="op">::</span><span class="kw">pretty_print_vector_values</span>(activity_biomarkers<span class="op">$</span>biomarkers.neg)</span></code></pre></div>
<blockquote>
<p>1 node: MAPK14</p>
</blockquote>
<p>Note that some nodes tend to have either no actual state differences between the MCC classes (so they are not important) or they take both negative and positive differences between the different MCC class pair comparisons (without surpassing the given threshold, so also not important for us here).</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-1"></a><span class="co"># color some important nodes and lower the threshold</span></span>
<span id="cb47-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-2"></a>param_biomarkers =<span class="st"> </span>emba<span class="op">::</span><span class="kw">get_biomarkers</span>(mcc_res<span class="op">$</span>diff.link.mcc.mat, <span class="dt">threshold =</span> <span class="fl">0.48</span>)</span>
<span id="cb47-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-3"></a></span>
<span id="cb47-4"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-4"></a>imp_nodes_colors =<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="kw">ncol</span>(mcc_res<span class="op">$</span>diff.link.mcc.mat))</span>
<span id="cb47-5"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-5"></a><span class="kw">names</span>(imp_nodes_colors) =<span class="st"> </span><span class="kw">colnames</span>(mcc_res<span class="op">$</span>diff.link.mcc.mat)</span>
<span id="cb47-6"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-6"></a>imp_nodes_colors[<span class="kw">names</span>(imp_nodes_colors) <span class="op">%in%</span><span class="st"> </span>param_biomarkers<span class="op">$</span>biomarkers.pos] =<span class="st"> &quot;green4&quot;</span></span>
<span id="cb47-7"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-7"></a>imp_nodes_colors[<span class="kw">names</span>(imp_nodes_colors) <span class="op">%in%</span><span class="st"> </span>param_biomarkers<span class="op">$</span>biomarkers.neg] =<span class="st"> &quot;red4&quot;</span></span>
<span id="cb47-8"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-8"></a></span>
<span id="cb47-9"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-9"></a><span class="co"># define coloring function of state differences</span></span>
<span id="cb47-10"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-10"></a>col_fun =<span class="st"> </span>circlize<span class="op">::</span><span class="kw">colorRamp2</span>(<span class="kw">c</span>(<span class="kw">min</span>(mcc_res<span class="op">$</span>diff.link.mcc.mat), <span class="dv">0</span>, <span class="kw">max</span>(mcc_res<span class="op">$</span>diff.link.mcc.mat)), </span>
<span id="cb47-11"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-11"></a>  <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;green&quot;</span>))</span>
<span id="cb47-12"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-12"></a></span>
<span id="cb47-13"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-13"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb47-14"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-14"></a>state_heat =<span class="st"> </span>ComplexHeatmap<span class="op">::</span><span class="kw">Heatmap</span>(<span class="dt">matrix =</span> mcc_res<span class="op">$</span>diff.link.mcc.mat, </span>
<span id="cb47-15"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-15"></a>  <span class="dt">name =</span> <span class="st">&quot;LO Difference&quot;</span>, <span class="dt">col =</span> col_fun,</span>
<span id="cb47-16"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-16"></a>  <span class="dt">row_title =</span> <span class="st">&quot;MCC Classes Pairs&quot;</span>, <span class="dt">row_names_side =</span> <span class="st">&quot;left&quot;</span>, </span>
<span id="cb47-17"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-17"></a>  <span class="dt">row_title_side =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">row_dend_side =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb47-18"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-18"></a>  <span class="dt">column_title =</span> <span class="st">&quot;Average Link Operator Differences between MCC Classes&quot;</span>, </span>
<span id="cb47-19"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-19"></a>  <span class="dt">column_names_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">11</span>, <span class="dt">col =</span> imp_nodes_colors),</span>
<span id="cb47-20"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-20"></a>  <span class="dt">heatmap_legend_param =</span> <span class="kw">list</span>(<span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>))</span>
<span id="cb47-21"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-21"></a></span>
<span id="cb47-22"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-22"></a>biomarkers_legend =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">title =</span> <span class="st">&quot;Link Operator Biomarkers&quot;</span>,</span>
<span id="cb47-23"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-23"></a>  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;OR-NOT (1)&quot;</span>, <span class="st">&quot;AND-NOT (0)&quot;</span>),</span>
<span id="cb47-24"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-24"></a>  <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;green4&quot;</span>, <span class="st">&quot;red4&quot;</span>)))</span>
<span id="cb47-25"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-25"></a></span>
<span id="cb47-26"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-26"></a><span class="kw">draw</span>(state_heat, <span class="dt">annotation_legend_list =</span> biomarkers_legend, </span>
<span id="cb47-27"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-27"></a>  <span class="dt">heatmap_legend_side =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">annotation_legend_side =</span> <span class="st">&quot;bottom&quot;</span>, </span>
<span id="cb47-28"><a href="cascade-1-0-analysis-1-ss-models.html#cb47-28"></a>  <span class="dt">merge_legend =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:emba-lo-biomarkers"></span>
<img src="index_files/figure-html/emba-lo-biomarkers-1.png" alt="Heatmap of Average Link Operator Differences (emba, 4 MCC Classes)" width="672" />
<p class="caption">
Figure 33: Heatmap of Average Link Operator Differences (emba, 4 MCC Classes)
</p>
</div>
<div class="green-box">
<p>We observe that <code>ERK_f</code> will have the <code>OR-NOT</code> link operator in most of the higher performance models and the <code>MAPK14</code> the <code>AND-NOT</code> link operator.
This of course relates to the fact that these nodes were found also as <em>active</em> and <em>inhibited</em> biomarkers respectively and that they have a very large observed agreement between stable state activity value and link operator parameterization (see <a href="https://bblodfon.github.io/brf-bias/cascade-1-0-data-analysis.html#fig:ss-lo-agreement-prop">analysis here</a>).</p>
<p>Interestingly, these two nodes (<code>ERK_f</code> and <code>MAPK14</code>) were 2 of the top most important nodes influencing the change of dynamics (number of attractors) in the link operator parameterization space of the CASCADE 1.0 network.</p>
</div>
</div>
<div id="random-forest-biomarkers" class="section level3 unnumbered" number="">
<h3>Random Forest biomarkers</h3>
<p>We use the <code>ranger</code> R package <span class="citation">(Wright and Ziegler <a href="references.html#ref-Wright2017" role="doc-biblioref">2017</a>)</span> to find <strong>important nodes/variables</strong> that determine the difference in performance (MCC score) between the input models.
Both the stable state data as well the link operator parameterization data will be used as training sets (see the script <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/perf_biomarkers_ranger.R">perf_biomarkers_ranger.R</a>).</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-1"></a>ranger_ss_mcc_res =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/ss_mcc_ranger_res.rds&quot;</span>)</span>
<span id="cb48-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-2"></a></span>
<span id="cb48-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-3"></a>imp_ss_rf =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">nodes =</span> <span class="kw">names</span>(ranger_ss_mcc_res<span class="op">$</span>variable.importance), </span>
<span id="cb48-4"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-4"></a>  <span class="dt">gini_index =</span> ranger_ss_mcc_res<span class="op">$</span>variable.importance)</span>
<span id="cb48-5"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-5"></a></span>
<span id="cb48-6"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-6"></a><span class="co"># color first 12 nodes in x axis</span></span>
<span id="cb48-7"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-7"></a>imp_col =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;green4&quot;</span>, <span class="dv">14</span>), <span class="kw">rep</span>(<span class="st">&quot;grey30&quot;</span>, <span class="kw">nrow</span>(imp_ss_rf) <span class="op">-</span><span class="st"> </span><span class="dv">14</span>))</span>
<span id="cb48-8"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-8"></a></span>
<span id="cb48-9"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-9"></a>imp_ss_rf <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-10"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">nodes =</span> forcats<span class="op">::</span><span class="kw">fct_reorder</span>(nodes, <span class="kw">desc</span>(gini_index))) <span class="op">%&gt;%</span></span>
<span id="cb48-11"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-11"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> nodes, <span class="dt">y =</span> gini_index, <span class="dt">fill =</span> gini_index)) <span class="op">+</span></span>
<span id="cb48-12"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-12"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb48-13"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-13"></a><span class="st">    </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb48-14"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-14"></a><span class="st">    </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb48-15"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-15"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">7</span>, <span class="dt">colour =</span> imp_col)) <span class="op">+</span></span>
<span id="cb48-16"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-16"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;RF Importance for MCC Classification (stable states)&quot;</span>, </span>
<span id="cb48-17"><a href="cascade-1-0-analysis-1-ss-models.html#cb48-17"></a>      <span class="dt">x =</span> <span class="st">&quot;Nodes&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Mean Decrease in Node Impurity&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:rf-mcc-state-imp"></span>
<img src="index_files/figure-html/rf-mcc-state-imp-1.png" alt="Random Forest Important Nodes for Performance Classification (MCC) based on stable state data" width="2100" />
<p class="caption">
Figure 34: Random Forest Important Nodes for Performance Classification (MCC) based on stable state data
</p>
</div>
<div class="green-box">
<p>We observe a lot of common important activity biomarkers (important nodes) between the random forest results and the <code>emba</code> results: <code>ERK_f</code>,<code>MAP3K7</code>,<code>MAP2K7</code>,<code>NLK</code>,<code>TAB_f</code> to name a few.</p>
</div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-1"></a>ranger_lo_mcc_res =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/lo_mcc_ranger_res.rds&quot;</span>)</span>
<span id="cb49-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-2"></a></span>
<span id="cb49-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-3"></a>imp_lo_rf =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">nodes =</span> <span class="kw">names</span>(ranger_lo_mcc_res<span class="op">$</span>variable.importance), </span>
<span id="cb49-4"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-4"></a>  <span class="dt">gini_index =</span> ranger_lo_mcc_res<span class="op">$</span>variable.importance)</span>
<span id="cb49-5"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-5"></a></span>
<span id="cb49-6"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-6"></a><span class="co"># color first 8 nodes in x axis</span></span>
<span id="cb49-7"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-7"></a>imp_col =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;green4&quot;</span>, <span class="dv">8</span>), <span class="kw">rep</span>(<span class="st">&quot;grey30&quot;</span>, <span class="kw">nrow</span>(imp_lo_rf) <span class="op">-</span><span class="st"> </span><span class="dv">8</span>))</span>
<span id="cb49-8"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-8"></a></span>
<span id="cb49-9"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-9"></a>imp_lo_rf <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb49-10"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">nodes =</span> forcats<span class="op">::</span><span class="kw">fct_reorder</span>(nodes, <span class="kw">desc</span>(gini_index))) <span class="op">%&gt;%</span></span>
<span id="cb49-11"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-11"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> nodes, <span class="dt">y =</span> gini_index, <span class="dt">fill =</span> gini_index)) <span class="op">+</span></span>
<span id="cb49-12"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-12"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb49-13"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-13"></a><span class="st">    </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb49-14"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-14"></a><span class="st">    </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb49-15"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-15"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> imp_col)) <span class="op">+</span></span>
<span id="cb49-16"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-16"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;RF Importance for MCC Classification (parameterization)&quot;</span>, </span>
<span id="cb49-17"><a href="cascade-1-0-analysis-1-ss-models.html#cb49-17"></a>      <span class="dt">x =</span> <span class="st">&quot;Nodes&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Mean Decrease in Node Impurity&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:rf-mcc-param-imp"></span>
<img src="index_files/figure-html/rf-mcc-param-imp-1.png" alt="Random Forest Important Nodes for Performance Classification (MCC) based on link operator data)" width="2100" />
<p class="caption">
Figure 35: Random Forest Important Nodes for Performance Classification (MCC) based on link operator data)
</p>
</div>
<div class="green-box">
<p><code>ERK_f</code> is a major link operator biomarker in both <code>emba</code> and random forest results</p>
</div>
</div>
<div id="emba-vs-rf-results" class="section level3 unnumbered" number="">
<h3>emba vs RF Results</h3>
<p>We check the correlation between <code>emba</code> (sum of absolute state differences for all comparison pairs per node, i.e. summing up the absolute values of the columns in the heatmaps above) and random forest (Gini Index) results:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-1"></a><span class="co"># compute total emba importance</span></span>
<span id="cb50-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-2"></a>imp_ss_emba =<span class="st"> </span>mcc_res<span class="op">$</span>diff.state.mcc.mat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">abs</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">colSums</span>()</span>
<span id="cb50-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-3"></a>imp_lo_emba =<span class="st"> </span>mcc_res<span class="op">$</span>diff.link.mcc.mat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">abs</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">colSums</span>()</span>
<span id="cb50-4"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-4"></a></span>
<span id="cb50-5"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-5"></a><span class="co"># make sure it&#39;s in the same order</span></span>
<span id="cb50-6"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-6"></a>imp_ss_emba =<span class="st"> </span>imp_ss_emba[imp_ss_rf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(nodes)]</span>
<span id="cb50-7"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-7"></a>imp_lo_emba =<span class="st"> </span>imp_lo_emba[imp_lo_rf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(nodes)]</span>
<span id="cb50-8"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-8"></a></span>
<span id="cb50-9"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-9"></a>imp_ss_rf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_column</span>(<span class="dt">emba_score =</span> imp_ss_emba) <span class="op">%&gt;%</span></span>
<span id="cb50-10"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-10"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> emba_score, <span class="dt">y =</span> gini_index)) <span class="op">+</span></span>
<span id="cb50-11"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-11"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb50-12"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-12"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x, <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb50-13"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-13"></a><span class="st">    </span>ggpubr<span class="op">::</span><span class="kw">stat_cor</span>(<span class="dt">method =</span> <span class="st">&quot;kendall&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;tau&quot;</span>) <span class="op">+</span></span>
<span id="cb50-14"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-14"></a><span class="st">    </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb50-15"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-15"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Random Forest vs emba variable importance results (Activity State)&quot;</span>,</span>
<span id="cb50-16"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-16"></a>      <span class="dt">x =</span> <span class="st">&quot;emba (Sum of absolute state differences)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;RF (Gini Index)&quot;</span>)</span>
<span id="cb50-17"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-17"></a></span>
<span id="cb50-18"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-18"></a>imp_lo_rf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_column</span>(<span class="dt">emba_score =</span> imp_lo_emba) <span class="op">%&gt;%</span></span>
<span id="cb50-19"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-19"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> emba_score, <span class="dt">y =</span> gini_index)) <span class="op">+</span></span>
<span id="cb50-20"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-20"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb50-21"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-21"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x, <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb50-22"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-22"></a><span class="st">    </span>ggpubr<span class="op">::</span><span class="kw">stat_cor</span>(<span class="dt">method =</span> <span class="st">&quot;kendall&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;tau&quot;</span>) <span class="op">+</span></span>
<span id="cb50-23"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-23"></a><span class="st">    </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb50-24"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-24"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Random Forest vs emba variable importance results (Parameterization)&quot;</span>,</span>
<span id="cb50-25"><a href="cascade-1-0-analysis-1-ss-models.html#cb50-25"></a>      <span class="dt">x =</span> <span class="st">&quot;emba (Sum of absolute link operator differences)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;RF (Gini Index)&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:cor-emba-rf"></span>
<img src="index_files/figure-html/cor-emba-rf-1.png" alt="Correlation between emba and Random Forest Importance Results" width="50%" /><img src="index_files/figure-html/cor-emba-rf-2.png" alt="Correlation between emba and Random Forest Importance Results" width="50%" />
<p class="caption">
Figure 36: Correlation between emba and Random Forest Importance Results
</p>
</div>
<div class="green-box">
<ul>
<li>We use the non-parametric Kendall correlation method and it’s rank-based correlation coefficient, <span class="math inline">\(\tau\)</span>.</li>
<li>There is <strong>a correlation between the importance results from the two different methods</strong>, even though the <code>emba</code> results are more <em>artificially-made</em> (like adding up absolute coefficient scores from linear models as a measure of importance) compared to the impurity metric which is a <em>built-in</em> feature of the tree-based algorithms such as random forests.
As a result for example, we observe a much greater granularity of the importance measurements in the activity state correlation figure.</li>
<li><code>emba</code> results are <strong>more verbose</strong> though in the sense that they allow <em>directionality</em> in their interpretation: we get which nodes must be activated or inhibited in the higher performance models or which should be parameterized with <code>OR-NOT</code> or <code>AND-NOT</code>, information which the random forests do not provide.</li>
<li><strong>Larger correlation</strong> is observed <strong>for the activity state</strong> compared to the parameterization results.</li>
</ul>
</div>
</div>
<div id="embedding-link-operator-biomarkers-in-the-map" class="section level3 unnumbered" number="">
<h3>Embedding Link Operator Biomarkers in the Map</h3>
<div class="blue-box">
<p>Using as a base the <strong>performance parameterization maps (supervised and unsupervised)</strong> for the 1 stable state models, we color the points (models) according to the <strong>link operator value</strong> of some of the <strong>performance biomarker</strong> that we found in the previous analysis using <code>emba</code> and random forests.</p>
</div>
<p>We give some examples of how the distribution of link-operator values looks like in the parameterization maps for the more important nodes (e.g. <code>ERK_f</code>, <code>MAPK14</code>) but also for the least important ones (e.g. <code>CYCS</code>, <code>CFLAR</code>).
See the script <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/perf_biomarkers_embedding.R">perf_biomarkers_embedding.R</a> for more details.
All the produced images by the script are accessible <a href="https://github.com/bblodfon/bool-param-maps/tree/master/img/nodes_lo_maps">here</a>.</p>
<p>Using as a base the <strong>unsupervised parameterization MAP with 14 neighbors</strong>, we have:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb51-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/nodes_lo_maps/unsup_MAPK14.png&quot;</span>)</span>
<span id="cb51-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb51-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/nodes_lo_maps/unsup_ERK_f.png&quot;</span>)</span>
<span id="cb51-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb51-3"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/nodes_lo_maps/unsup_CFLAR.png&quot;</span>)</span>
<span id="cb51-4"><a href="cascade-1-0-analysis-1-ss-models.html#cb51-4"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/nodes_lo_maps/unsup_CYCS.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:nodes-lo-maps-1"></span>
<img src="img/nodes_lo_maps/unsup_MAPK14.png" alt="MCC Unsupervised Parameterization maps colored by link-operator values of different performance biomarkers" width="50%" /><img src="img/nodes_lo_maps/unsup_ERK_f.png" alt="MCC Unsupervised Parameterization maps colored by link-operator values of different performance biomarkers" width="50%" /><img src="img/nodes_lo_maps/unsup_CFLAR.png" alt="MCC Unsupervised Parameterization maps colored by link-operator values of different performance biomarkers" width="50%" /><img src="img/nodes_lo_maps/unsup_CYCS.png" alt="MCC Unsupervised Parameterization maps colored by link-operator values of different performance biomarkers" width="50%" />
<p class="caption">
Figure 37: MCC Unsupervised Parameterization maps colored by link-operator values of different performance biomarkers
</p>
</div>
<p>Using as a base the <strong>supervised parameterization MAP with 14 neighbors (MCC as continuous variable)</strong>, we have:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb52-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/nodes_lo_maps/sup_cont_MAPK14.png&quot;</span>)</span>
<span id="cb52-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb52-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/nodes_lo_maps/sup_cont_ERK_f.png&quot;</span>)</span>
<span id="cb52-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb52-3"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/nodes_lo_maps/sup_cont_CFLAR.png&quot;</span>)</span>
<span id="cb52-4"><a href="cascade-1-0-analysis-1-ss-models.html#cb52-4"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/nodes_lo_maps/sup_cont_CYCS.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:nodes-lo-maps-2"></span>
<img src="img/nodes_lo_maps/sup_cont_MAPK14.png" alt="MCC Supervised Parameterization maps (MCC continuous) colored by link-operator values of different performance biomarkers" width="50%" /><img src="img/nodes_lo_maps/sup_cont_ERK_f.png" alt="MCC Supervised Parameterization maps (MCC continuous) colored by link-operator values of different performance biomarkers" width="50%" /><img src="img/nodes_lo_maps/sup_cont_CFLAR.png" alt="MCC Supervised Parameterization maps (MCC continuous) colored by link-operator values of different performance biomarkers" width="50%" /><img src="img/nodes_lo_maps/sup_cont_CYCS.png" alt="MCC Supervised Parameterization maps (MCC continuous) colored by link-operator values of different performance biomarkers" width="50%" />
<p class="caption">
Figure 38: MCC Supervised Parameterization maps (MCC continuous) colored by link-operator values of different performance biomarkers
</p>
</div>
<p>Using as a base the <strong>supervised parameterization MAP with 14 neighbors (MCC as discrete class variable)</strong>, we have:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb53-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/nodes_lo_maps/sup_MAPK14.png&quot;</span>)</span>
<span id="cb53-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb53-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/nodes_lo_maps/sup_ERK_f.png&quot;</span>)</span>
<span id="cb53-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb53-3"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/nodes_lo_maps/sup_CFLAR.png&quot;</span>)</span>
<span id="cb53-4"><a href="cascade-1-0-analysis-1-ss-models.html#cb53-4"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/nodes_lo_maps/sup_CYCS.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:nodes-lo-maps-3"></span>
<img src="img/nodes_lo_maps/sup_MAPK14.png" alt="MCC Supervised Parameterization maps (MCC discrete) colored by link-operator values of different performance biomarkers" width="50%" /><img src="img/nodes_lo_maps/sup_ERK_f.png" alt="MCC Supervised Parameterization maps (MCC discrete) colored by link-operator values of different performance biomarkers" width="50%" /><img src="img/nodes_lo_maps/sup_CFLAR.png" alt="MCC Supervised Parameterization maps (MCC discrete) colored by link-operator values of different performance biomarkers" width="50%" /><img src="img/nodes_lo_maps/sup_CYCS.png" alt="MCC Supervised Parameterization maps (MCC discrete) colored by link-operator values of different performance biomarkers" width="50%" />
<p class="caption">
Figure 39: MCC Supervised Parameterization maps (MCC discrete) colored by link-operator values of different performance biomarkers
</p>
</div>
<div class="green-box">
<p>We observe that both in the unsupervised parameterization maps and the MCC-supervised ones (especially the continuous one), <strong>the less important a node is, the more chaotically it’s link operator value manifests across the map</strong>.</p>
</div>
</div>
</div>
<div id="synergy-maps" class="section level2 unnumbered" number="">
<h2>Synergy Maps</h2>
<p>As stated in a <a href="cascade-1-0-analysis-1-ss-models.html#performance-maps">previous section</a>, the CASCADE 1.0 models produced by <code>abmlog</code> were tested for synergy against the drug combination dataset in <span class="citation">Flobak et al. (<a href="references.html#ref-Flobak2015" role="doc-biblioref">2015</a>)</span>.
Using the <em>HSA</em> method to define a drug combination as synergistic or not (antagonistic), we first present some useful statistics (see script <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/synergy_maps.R">synergy_maps.R</a>):</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb54-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&#39;img/synergy_stats.png&#39;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:syn-stats"></span>
<img src="img/synergy_stats.png" alt="Synergy Statistics across all CASCADE 1.0 models with 1 stable state" width="1050" />
<p class="caption">
Figure 40: Synergy Statistics across all CASCADE 1.0 models with 1 stable state
</p>
</div>
<div class="orange-box">
<p>For the ‘NA’ models, either one of the two single-drug perturbed models or the double-perturbed model, did not have any fixpoint attractors.</p>
</div>
<p>We observe that <strong>only a very few models</strong> (compared to the total parameterization space) can predict the observed drug combinations as <em>synergistic</em>.
This can be visualized also in the next synergy maps:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb55-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_maps/AK-5Z_2nn.png&quot;</span>)</span>
<span id="cb55-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb55-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_maps/AK-5Z_14nn.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:syn-maps-1"></span>
<img src="img/synergy_maps/AK-5Z_2nn.png" alt="AK-PZ Synergy Parameterization Maps" width="50%" /><img src="img/synergy_maps/AK-5Z_14nn.png" alt="AK-PZ Synergy Parameterization Maps" width="50%" />
<p class="caption">
Figure 41: AK-PZ Synergy Parameterization Maps
</p>
</div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb56-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_maps/PD-AK_2nn.png&quot;</span>)</span>
<span id="cb56-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb56-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_maps/PD-AK_14nn.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:syn-maps-2"></span>
<img src="img/synergy_maps/PD-AK_2nn.png" alt="PD-AK Synergy Parameterization Maps" width="50%" /><img src="img/synergy_maps/PD-AK_14nn.png" alt="PD-AK Synergy Parameterization Maps" width="50%" />
<p class="caption">
Figure 42: PD-AK Synergy Parameterization Maps
</p>
</div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb57-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_maps/PI-PD_2nn.png&quot;</span>)</span>
<span id="cb57-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb57-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_maps/PI-PD_14nn.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:syn-maps-3"></span>
<img src="img/synergy_maps/PI-PD_2nn.png" alt="PI-PD Synergy Parameterization Maps" width="50%" /><img src="img/synergy_maps/PI-PD_14nn.png" alt="PI-PD Synergy Parameterization Maps" width="50%" />
<p class="caption">
Figure 43: PI-PD Synergy Parameterization Maps
</p>
</div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb58-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_maps/PI-5Z_2nn.png&quot;</span>)</span>
<span id="cb58-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb58-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_maps/PI-5Z_14nn.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:syn-maps-4"></span>
<img src="img/synergy_maps/PI-5Z_2nn.png" alt="PI-PZ Synergy Parameterization Maps" width="50%" /><img src="img/synergy_maps/PI-5Z_14nn.png" alt="PI-PZ Synergy Parameterization Maps" width="50%" />
<p class="caption">
Figure 44: PI-PZ Synergy Parameterization Maps
</p>
</div>
<div class="green-box">
<p>As we have seen, the UMAP results with higher number of neighbors cluster the similarly parameterized models better.
This makes it easier to spot the <strong>small clusters</strong> which include models that can predict each of the respective observed synergies as <em>synergistic</em>.</p>
<p>We note that all of these <strong>synergistic sub-clusters</strong> are part of the <strong>high-performance supercluster</strong> (right one in the images above).</p>
</div>
<p>Interestingly, if we see consider <strong>all possible observed synergy subsets</strong> we see that there are models that can predict the double synergy set <code>PI-PD,PD-AK</code> and the <code>PI-5Z,AK-5Z</code>, but there is literally <strong>no model that can predict three or four (all) of the observed synergies</strong>:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb59-1"></a>synergy_subset_stats =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/synergy_subset_stats.rds&quot;</span>)</span>
<span id="cb59-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb59-2"></a>usefun<span class="op">::</span><span class="kw">pretty_print_vector_names_and_values</span>(synergy_subset_stats)</span></code></pre></div>
<blockquote>
<p>: 2675360, PI-PD: 59616, PI-5Z: 31968, PD-AK: 1536, AK-5Z: 85248, PI-PD,PD-AK: 1536, PI-5Z,AK-5Z: 31968</p>
</blockquote>
<p>This is another proof that this parameterization is <em>restrictive</em> since there is not even one possible parameterization which represents biological reality (i.e. treatment with the previously mentioned four drug combinations is synergistic).</p>
<p>Also, looking at the numbers of models for each set of synergies, we see that the models predicting the <code>PD-AK</code> synergy form a proper subset of the <code>PI-PD,PD-AK</code> models and the same for <code>PI-5Z</code> and <code>PI-5Z,AK-5Z</code>.
Thus we include only the parent sets in the next synergy maps, where we have combined all synergies in one:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb60-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_maps/all_syn_11nn.png&quot;</span>)</span>
<span id="cb60-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb60-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_maps/all_syn_14nn.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:syn-maps-5"></span>
<img src="img/synergy_maps/all_syn_11nn.png" alt="Combined Synergy Parameterization Maps" width="50%" /><img src="img/synergy_maps/all_syn_14nn.png" alt="Combined Synergy Parameterization Maps" width="50%" />
<p class="caption">
Figure 45: Combined Synergy Parameterization Maps
</p>
</div>
<div class="green-box">
<p>We observe that there are <strong>two synergy sub-clusters</strong>, one primarily related to the <code>PD</code> drug and the other to the <code>5Z</code> drug.
Since the synergies belong to <span class="math inline">\(2\)</span> mutually exclusive (in terms of parameterization) clusters, this is a visual cue that there cannot be a model that predicts all 4 of these synergies.</p>
</div>
</div>
<div id="stable-state-patterns-in-synergistic-models" class="section level2 unnumbered" number="">
<h2>Stable State Patterns in Synergistic models</h2>
<div class="blue-box">
<p>We want to identify if there are <strong>activity patterns</strong> in the models that predict the observed synergies.</p>
<p>To do this, we take a random sample of such synergistic models that predict each of the <span class="math inline">\(4\)</span> observed synergies and show the corresponding heatmaps of stable state activities.
More details on the <a href="https://github.com/bblodfon/bool-param-maps/blob/master/scripts/synergy_heatmaps.R">synergy_heatmaps.R</a> script.</p>
</div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb61-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_heatmaps/PD-AK_ss_heat.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:synergy-heatmaps"></span>
<img src="img/synergy_heatmaps/PD-AK_ss_heat.png" alt="PD-AK stable state activity heatmap" width="2100" />
<p class="caption">
Figure 46: PD-AK stable state activity heatmap
</p>
</div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb62-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_heatmaps/PI-PD_ss_heat.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:synergy-heatmaps-2"></span>
<img src="img/synergy_heatmaps/PI-PD_ss_heat.png" alt="PI-PD stable state activity heatmap" width="2100" />
<p class="caption">
Figure 47: PI-PD stable state activity heatmap
</p>
</div>
<div class="green-box">
<ul>
<li>All the models that predict the <code>PD-AK</code> synergy show one <strong>distinct activity state pattern</strong></li>
<li>The <code>PI-PD</code> heatmap is more <em>heterogeneous</em> (though still patterns do exist).
The reason for this might be because the parameterization is more spread out across the map in the combined synergy <a href="cascade-1-0-analysis-1-ss-models.html#fig:syn-maps-5">figure above</a> - i.e. some models are in the low-performance supercluster.</li>
</ul>
</div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb63-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_heatmaps/AK-5Z_ss_heat.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:synergy-heatmaps-3"></span>
<img src="img/synergy_heatmaps/AK-5Z_ss_heat.png" alt="AK-5Z stable state activity heatmaps" width="2100" />
<p class="caption">
Figure 48: AK-5Z stable state activity heatmaps
</p>
</div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb64-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/synergy_heatmaps/PI-5Z_ss_heat.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:synergy-heatmaps-4"></span>
<img src="img/synergy_heatmaps/PI-5Z_ss_heat.png" alt="PI-5Z stable state activity heatmaps" width="2100" />
<p class="caption">
Figure 49: PI-5Z stable state activity heatmaps
</p>
</div>
<div class="green-box">
<p>All the synergistic models in the <code>5Z</code> sub-cluster seem to follow the <strong>same stable state activity patterns</strong> (pretty much we get the same node names in the columns after the clustering in the heatmaps).
There exist <span class="math inline">\(2\)</span> <strong>main such patterns</strong>, specified by the state vector (ON,{ON/OFF},{OFF/ON},ON) - where ON and OFF denote vectors of <em>active</em>/<em>inhibited</em> nodes that are clustered together.</p>
</div>
<p>Note that in all <span class="math inline">\(4\)</span> heatmaps above, the <code>Prosurvival</code> node is always <em>active</em>, denoting proliferating activity patterns in the boolean models where synergies can manifest.</p>
</div>
<div id="synergy-biomarkers" class="section level2 unnumbered" number="">
<h2>Synergy Biomarkers</h2>
<div class="blue-box">
<p>We assess <strong>important nodes (biomarkers)</strong> whose <em>activity</em> and/or link-operator (<em>parameterization</em>) affects the manifestation of the <span class="math inline">\(4\)</span> observed synergies.</p>
</div>
<p>Here, <code>emba</code> <span class="citation">(Zobolas, Kuiper, and Flobak <a href="references.html#ref-Zobolas2020" role="doc-biblioref">2020</a>)</span> performs the classification to <em>synergistic</em> and <em>antagonistic</em> model groups per synergy observed (as exemplified by the <a href="cascade-1-0-analysis-1-ss-models.html#fig:syn-stats">figure above</a> - the <code>NA</code> models are discarded) and compares the average stable state activities and link operator values of each node in the two groups.</p>
<p>In the next heatmap, a positive (resp. negative) state difference for a node denotes that its activity value was larger (resp. lower) in the corresponding synergistic model group:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-1"></a>syn_res =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/synergy_res.rds&quot;</span>)</span>
<span id="cb65-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-2"></a></span>
<span id="cb65-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-3"></a><span class="co"># define coloring function of state differences</span></span>
<span id="cb65-4"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-4"></a>col_fun =<span class="st"> </span>circlize<span class="op">::</span><span class="kw">colorRamp2</span>(<span class="kw">c</span>(<span class="kw">min</span>(syn_res<span class="op">$</span>diff.state.synergies.mat), </span>
<span id="cb65-5"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-5"></a>  <span class="dv">0</span>, <span class="kw">max</span>(syn_res<span class="op">$</span>diff.state.synergies.mat)), <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;green&quot;</span>))</span>
<span id="cb65-6"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-6"></a></span>
<span id="cb65-7"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-7"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb65-8"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-8"></a>state_syn_heat =<span class="st"> </span>ComplexHeatmap<span class="op">::</span><span class="kw">Heatmap</span>(<span class="dt">matrix =</span> syn_res<span class="op">$</span>diff.state.synergies.mat, </span>
<span id="cb65-9"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-9"></a>  <span class="dt">name =</span> <span class="st">&quot;State Difference&quot;</span>, <span class="dt">col =</span> col_fun,</span>
<span id="cb65-10"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-10"></a>  <span class="dt">row_title =</span> <span class="st">&quot;Synergistic Drug Combinations&quot;</span>, <span class="dt">row_names_side =</span> <span class="st">&quot;left&quot;</span>, </span>
<span id="cb65-11"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-11"></a>  <span class="dt">row_title_side =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">row_dend_side =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb65-12"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-12"></a>  <span class="dt">column_title =</span> <span class="st">&quot;Average State Differences (Synergistic vs Antagonistic)&quot;</span>, </span>
<span id="cb65-13"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-13"></a>  <span class="dt">column_names_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">5</span>),</span>
<span id="cb65-14"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-14"></a>  <span class="dt">heatmap_legend_param =</span> <span class="kw">list</span>(<span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>))</span>
<span id="cb65-15"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-15"></a></span>
<span id="cb65-16"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-16"></a>biomarkers_legend =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">title =</span> <span class="st">&quot;Activity State Biomarkers&quot;</span>,</span>
<span id="cb65-17"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-17"></a>  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Inhibited&quot;</span>),</span>
<span id="cb65-18"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-18"></a>  <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;green4&quot;</span>, <span class="st">&quot;red4&quot;</span>)))</span>
<span id="cb65-19"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-19"></a></span>
<span id="cb65-20"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-20"></a><span class="kw">draw</span>(state_syn_heat, <span class="dt">annotation_legend_list =</span> biomarkers_legend, </span>
<span id="cb65-21"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-21"></a>  <span class="dt">heatmap_legend_side =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">annotation_legend_side =</span> <span class="st">&quot;bottom&quot;</span>, </span>
<span id="cb65-22"><a href="cascade-1-0-analysis-1-ss-models.html#cb65-22"></a>  <span class="dt">merge_legend =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="figure"><span id="fig:state-syn-heat"></span>
<img src="index_files/figure-html/state-syn-heat-1.png" alt="Heatmap of Average State Differences between synergistic and antagonistic model groups for each observed synergy" width="672" />
<p class="caption">
Figure 50: Heatmap of Average State Differences between synergistic and antagonistic model groups for each observed synergy
</p>
</div>
<div class="green-box">
<ul>
<li>The activity state biomarkers are clustered in two categories representing the two synergy sub-clusters we found previously, namely the <code>5Z</code> sub-cluster and the <code>PD</code> sub-cluster.</li>
<li>The models predicting the <code>5Z</code> synergies seem to have more <strong>active state biomarkers</strong>, whereas the models predicting the <code>PD</code> synergies seem to have more <strong>inhibited state biomarkers</strong>.</li>
<li><code>MAPK14</code> seems to be a <strong>definitive node distinguishing the two synergy subgroups</strong>, since it’s a strong inhibited biomarker for the <code>5Z</code> synergies, but a fairly unimportant node for the <code>PD</code> synergies.</li>
<li><code>ERK_f</code> is an active state biomarker (same observation was found in the <em>performance</em> biomarkers analysis)</li>
</ul>
</div>
<p>In the next heatmap, a positive (resp. negative) link operator difference for a node denotes that its link operator was mostly <code>OR-NOT</code> (resp. <code>AND-NOT</code>) in the corresponding synergistic model group:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-1"></a><span class="co"># define coloring function of state differences</span></span>
<span id="cb66-2"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-2"></a>col_fun =<span class="st"> </span>circlize<span class="op">::</span><span class="kw">colorRamp2</span>(<span class="kw">c</span>(<span class="kw">min</span>(syn_res<span class="op">$</span>diff.link.synergies.mat), </span>
<span id="cb66-3"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-3"></a>  <span class="dv">0</span>, <span class="kw">max</span>(syn_res<span class="op">$</span>diff.link.synergies.mat)), <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;green&quot;</span>))</span>
<span id="cb66-4"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-4"></a></span>
<span id="cb66-5"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-5"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb66-6"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-6"></a>lo_syn_heat =<span class="st"> </span>ComplexHeatmap<span class="op">::</span><span class="kw">Heatmap</span>(<span class="dt">matrix =</span> syn_res<span class="op">$</span>diff.link.synergies.mat, </span>
<span id="cb66-7"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-7"></a>  <span class="dt">name =</span> <span class="st">&quot;Link Operator Difference&quot;</span>, <span class="dt">col =</span> col_fun,</span>
<span id="cb66-8"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-8"></a>  <span class="dt">row_title =</span> <span class="st">&quot;Synergistic Drug Combinations&quot;</span>, <span class="dt">row_names_side =</span> <span class="st">&quot;left&quot;</span>, </span>
<span id="cb66-9"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-9"></a>  <span class="dt">row_title_side =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">row_dend_side =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb66-10"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-10"></a>  <span class="dt">column_title =</span> <span class="st">&quot;Average Link Operator Differences (Synergistic vs Antagonistic)&quot;</span>, </span>
<span id="cb66-11"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-11"></a>  <span class="dt">column_names_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">11</span>),</span>
<span id="cb66-12"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-12"></a>  <span class="dt">heatmap_legend_param =</span> <span class="kw">list</span>(<span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>))</span>
<span id="cb66-13"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-13"></a></span>
<span id="cb66-14"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-14"></a>biomarkers_legend =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">title =</span> <span class="st">&quot;Link Operator Biomarkers&quot;</span>,</span>
<span id="cb66-15"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-15"></a>  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;OR-NOT (1)&quot;</span>, <span class="st">&quot;AND-NOT (0)&quot;</span>),</span>
<span id="cb66-16"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-16"></a>  <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;green4&quot;</span>, <span class="st">&quot;red4&quot;</span>)))</span>
<span id="cb66-17"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-17"></a></span>
<span id="cb66-18"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-18"></a><span class="kw">draw</span>(lo_syn_heat, <span class="dt">annotation_legend_list =</span> biomarkers_legend, </span>
<span id="cb66-19"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-19"></a>  <span class="dt">heatmap_legend_side =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">annotation_legend_side =</span> <span class="st">&quot;bottom&quot;</span>, </span>
<span id="cb66-20"><a href="cascade-1-0-analysis-1-ss-models.html#cb66-20"></a>  <span class="dt">merge_legend =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="figure"><span id="fig:lo-syn-heat"></span>
<img src="index_files/figure-html/lo-syn-heat-1.png" alt="Heatmap of Average Link Operator Differences between synergistic and antagonistic model groups for each observed synergy" width="672" />
<p class="caption">
Figure 51: Heatmap of Average Link Operator Differences between synergistic and antagonistic model groups for each observed synergy
</p>
</div>
<div class="green-box">
<ul>
<li><code>ERK_f</code> is a strong synergy OR-NOT biomarker for all synergies (same as in the <em>performance</em> link-operator biomarkers section and shown in this <a href="cascade-1-0-analysis-1-ss-models.html#fig:nodes-lo-maps-1">figure</a>)</li>
<li><code>MAPK14</code> is again the node that mostly distinguishes between the two synergy sub-clusters of <code>PD</code> and <code>5Z</code>.
This also relates to the embedding of the <code>MAPK14</code> link-operator value as demonstrated by this <a href="cascade-1-0-analysis-1-ss-models.html#fig:nodes-lo-maps-1">figure</a>, where the <code>MAPK14</code> node has the <code>OR-NOT</code> link-operator in the <code>PD</code> sub-cluster and <code>AND-NOT</code> in the <code>5Z</code> sub-cluster.</li>
</ul>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cascade-1-0-parameterization-vs-fixpoints.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-session-info.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
