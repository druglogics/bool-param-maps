<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>CASCADE 1.0 Analysis (All models) | A study in boolean model parameterization</title>
  <meta name="description" content="Investigations related to link operators mutations in boolean models" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="CASCADE 1.0 Analysis (All models) | A study in boolean model parameterization" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bblodfon.github.io/balance-paper/" />
  
  <meta property="og:description" content="Investigations related to link operators mutations in boolean models" />
  <meta name="github-repo" content="bblodfon/balance-paper" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="CASCADE 1.0 Analysis (All models) | A study in boolean model parameterization" />
  
  <meta name="twitter:description" content="Investigations related to link operators mutations in boolean models" />
  

<meta name="author" content="John Zobolas" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bbr-function-analysis.html"/>
<link rel="next" href="cascade-1-0-analysis-1-ss-models.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Sections</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Intro</a></li>
<li class="chapter" data-level="" data-path="bbr-function-analysis.html"><a href="bbr-function-analysis.html"><i class="fa fa-check"></i>BBR Function Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="bbr-function-analysis.html"><a href="bbr-function-analysis.html#bbrs"><i class="fa fa-check"></i>Balance Boolean Regulatory Functions (BBRs)</a></li>
<li class="chapter" data-level="" data-path="bbr-function-analysis.html"><a href="bbr-function-analysis.html#truth-density-data-analysis"><i class="fa fa-check"></i>Truth Density Data Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="bbr-function-analysis.html"><a href="bbr-function-analysis.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="bbr-function-analysis.html"><a href="bbr-function-analysis.html#truth-density-formulas"><i class="fa fa-check"></i>Truth Density formulas</a></li>
<li><a href="bbr-function-analysis.html#stand-eq-bias"><em>AND-NOT</em> vs <em>OR-NOT</em> TD</a></li>
<li><a href="bbr-function-analysis.html#balanceop1-td"><em>BalanceOp1</em> TD</a></li>
<li class="chapter" data-level="" data-path="bbr-function-analysis.html"><a href="bbr-function-analysis.html#threshold-functions-td"><i class="fa fa-check"></i>Threshold Functions TD</a></li>
<li class="chapter" data-level="" data-path="bbr-function-analysis.html"><a href="bbr-function-analysis.html#td-data-distance"><i class="fa fa-check"></i>TD Data Distance</a></li>
<li class="chapter" data-level="" data-path="bbr-function-analysis.html"><a href="bbr-function-analysis.html#correlation"><i class="fa fa-check"></i>Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-all-models.html"><a href="cascade-1-0-analysis-all-models.html"><i class="fa fa-check"></i>CASCADE 1.0 Analysis (All models)</a>
<ul>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-all-models.html"><a href="cascade-1-0-analysis-all-models.html#network-properties"><i class="fa fa-check"></i>Network Properties</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-all-models.html"><a href="cascade-1-0-analysis-all-models.html#model-stable-state-statistics"><i class="fa fa-check"></i>Model Stable State Statistics</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-all-models.html"><a href="cascade-1-0-analysis-all-models.html#stable-states-data"><i class="fa fa-check"></i>Stable States Data</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-all-models.html"><a href="cascade-1-0-analysis-all-models.html#parameterization-vs-fixpoints"><i class="fa fa-check"></i>Parameterization vs #fixpoints</a>
<ul>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-all-models.html"><a href="cascade-1-0-analysis-all-models.html#glmnet"><i class="fa fa-check"></i>Glmnet</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-all-models.html"><a href="cascade-1-0-analysis-all-models.html#random-forest"><i class="fa fa-check"></i>Random Forest</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-all-models.html"><a href="cascade-1-0-analysis-all-models.html#parameterization-map"><i class="fa fa-check"></i>Parameterization Map</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-all-models.html"><a href="cascade-1-0-analysis-all-models.html#embedding-important-nodes-in-the-map"><i class="fa fa-check"></i>Embedding Important Nodes in the Map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html"><i class="fa fa-check"></i>CASCADE 1.0 Analysis (1 ss models)</a>
<ul>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#parameterization-and-stable-state-agreement"><i class="fa fa-check"></i>Parameterization and Stable State Agreement</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#parameterization-and-stable-state-agreement-cascade-2.0"><i class="fa fa-check"></i>Parameterization and Stable State Agreement (Cascade 2.0)</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#d-model-parameterization-maps"><i class="fa fa-check"></i>2D Model Parameterization Maps</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#gitsbe-models-on-the-map"><i class="fa fa-check"></i>Gitsbe Models on the Map</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#performance-maps"><i class="fa fa-check"></i>Performance Maps</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#fitness-maps"><i class="fa fa-check"></i>Fitness Maps</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#performance-biomarkers"><i class="fa fa-check"></i>Performance biomarkers</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#performance-vs-fitness"><i class="fa fa-check"></i>Performance vs Fitness</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#synergy-maps"><i class="fa fa-check"></i>Synergy Maps</a></li>
<li class="chapter" data-level="" data-path="cascade-1-0-analysis-1-ss-models.html"><a href="cascade-1-0-analysis-1-ss-models.html#synergy-biomarkers"><i class="fa fa-check"></i>Synergy Biomarkers</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-session-info.html"><a href="r-session-info.html"><i class="fa fa-check"></i>R session info</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A study in boolean model parameterization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cascade-1.0-analysis-all-models" class="section level1 unnumbered" number="">
<h1>CASCADE 1.0 Analysis (All models)</h1>
<div id="network-properties" class="section level2 unnumbered" number="">
<h2>Network Properties</h2>
<div class="blue-box">
<p>In this section we demonstrate the <strong>scale-free properties of the CASCADE 1.0 network</strong>.
We show that both in- and out-degree distributions are asymptotically power-law.</p>
</div>
<p>Use the script <a href="https://github.com/bblodfon/balance-paper/blob/master/scripts/get_distribution_stats.R">get_distribution_stats.R</a> to generate the degree distribution stats.
We load the results:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="cascade-1-0-analysis-all-models.html#cb17-1"></a>dd_stats =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/dd_stats.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="cascade-1-0-analysis-all-models.html#cb18-1"></a>dd_stats <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(in_degree) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tally</span>() <span class="op">%&gt;%</span></span>
<span id="cb18-2"><a href="cascade-1-0-analysis-all-models.html#cb18-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> in_degree, <span class="dt">y =</span> n)) <span class="op">+</span></span>
<span id="cb18-3"><a href="cascade-1-0-analysis-all-models.html#cb18-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">width =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-4"><a href="cascade-1-0-analysis-all-models.html#cb18-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>), <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-5"><a href="cascade-1-0-analysis-all-models.html#cb18-5"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb18-6"><a href="cascade-1-0-analysis-all-models.html#cb18-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;In-Degree Distribution (CASCADE 1.0)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;In Degree&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Number of Nodes&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:in-degree-fig"></span>
<img src="index_files/figure-html/in-degree-fig-1.png" alt="In Degree Distribution (CASCADE 1.0)" width="2100" />
<p class="caption">
Figure 8: In Degree Distribution (CASCADE 1.0)
</p>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="cascade-1-0-analysis-all-models.html#cb19-1"></a>dd_stats <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(out_degree) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tally</span>() <span class="op">%&gt;%</span></span>
<span id="cb19-2"><a href="cascade-1-0-analysis-all-models.html#cb19-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> out_degree, <span class="dt">y =</span> n)) <span class="op">+</span></span>
<span id="cb19-3"><a href="cascade-1-0-analysis-all-models.html#cb19-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-4"><a href="cascade-1-0-analysis-all-models.html#cb19-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>), <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">span =</span> <span class="fl">0.58</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-5"><a href="cascade-1-0-analysis-all-models.html#cb19-5"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb19-6"><a href="cascade-1-0-analysis-all-models.html#cb19-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Out-Degree Distribution (CASCADE 1.0)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Out Degree&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Number of Nodes&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:out-degree-fig"></span>
<img src="index_files/figure-html/out-degree-fig-1.png" alt="Out Degree Distribution (CASCADE 1.0)" width="2100" />
<p class="caption">
Figure 9: Out Degree Distribution (CASCADE 1.0)
</p>
</div>
</div>
<div id="model-stable-state-statistics" class="section level2 unnumbered" number="">
<h2>Model Stable State Statistics</h2>
<p>Using <a href="https://github.com/druglogics/abmlog">abmlog</a> we generated all <span class="math inline">\(2^{23} = 8388608\)</span> possible link operator mutated models for the CASCADE 1.0 topology.
The models are stored in both <code>.gitsbe</code> and <code>.bnet</code> files in the Zenodo dataset <a href="https://doi.org/10.5281/zenodo.4022783"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.4022783.svg" alt="DOI" /></a>.
The <code>gitsbe</code> files include also the fixpoint attractors.
Thus we can find the <em>frequency distribution</em> of the number of fixpoints across all produced models (use the script <a href="https://github.com/bblodfon/balance-paper/blob/master/scripts/count_model_ss.R">count_model_ss.R</a>).
The model stable state (fixpoint) statistics are as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="cascade-1-0-analysis-all-models.html#cb20-1"></a>models_ss_stats =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/models_ss_stats.rds&quot;</span>)</span>
<span id="cb20-2"><a href="cascade-1-0-analysis-all-models.html#cb20-2"></a></span>
<span id="cb20-3"><a href="cascade-1-0-analysis-all-models.html#cb20-3"></a>models_ss_stats <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(ss_num) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tally</span>() <span class="op">%&gt;%</span></span>
<span id="cb20-4"><a href="cascade-1-0-analysis-all-models.html#cb20-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ss_num, <span class="dt">y =</span> n, <span class="dt">fill =</span> <span class="kw">as.factor</span>(ss_num))) <span class="op">+</span></span>
<span id="cb20-5"><a href="cascade-1-0-analysis-all-models.html#cb20-5"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-6"><a href="cascade-1-0-analysis-all-models.html#cb20-6"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> n), <span class="dt">vjust =</span> <span class="fl">-0.5</span>) <span class="op">+</span></span>
<span id="cb20-7"><a href="cascade-1-0-analysis-all-models.html#cb20-7"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">paste0</span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="kw">round</span>(n<span class="op">/</span><span class="kw">nrow</span>(models_ss_stats), <span class="dt">digits =</span> <span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)), <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">vjust =</span> <span class="kw">c</span>(<span class="fl">2.5</span>, <span class="fl">2.5</span>, <span class="dv">-2</span>)) <span class="op">+</span></span>
<span id="cb20-8"><a href="cascade-1-0-analysis-all-models.html#cb20-8"></a><span class="st">  </span><span class="kw">theme_classic2</span>() <span class="op">+</span></span>
<span id="cb20-9"><a href="cascade-1-0-analysis-all-models.html#cb20-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></span>
<span id="cb20-10"><a href="cascade-1-0-analysis-all-models.html#cb20-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Stable States Distribution&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Number of Stable States&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Number of models&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:ss-stats-all"></span>
<img src="index_files/figure-html/ss-stats-all-1.png" alt="Stable States Distribution across all link-operator parameterized models (CASCADE 1.0)" width="2100" />
<p class="caption">
Figure 10: Stable States Distribution across all link-operator parameterized models (CASCADE 1.0)
</p>
</div>
<div class="green-box">
<p>Less than <span class="math inline">\(50\%\)</span> of the total possible parameterized models have a single fixpoint attractor which corresponds to a single stable phenotype behaviour.</p>
</div>
</div>
<div id="stable-states-data" class="section level2 unnumbered" number="">
<h2>Stable States Data</h2>
<div class="note">
<p>To load the stable state data for the models that have <strong>1 stable state</strong> use the Zenodo dataset <a href="https://doi.org/10.5281/zenodo.4022783"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.4022783.svg" alt="DOI" /></a> and the script <a href="https://github.com/bblodfon/balance-paper/blob/master/scripts/get_ss_data.R">get_ss_data.R</a></p>
</div>
</div>
<div id="parameterization-vs-fixpoints" class="section level2 unnumbered" number="">
<h2>Parameterization vs #fixpoints</h2>
<div class="blue-box">
<p>In this subsection we identidy the <strong>key nodes</strong> whose parameterization affects the <em>change of dynamics</em> of the CASCADE 1.0 network, i.e.Â are responsible for the <strong>change in the number of fixpoint attractors (0,1 and 2)</strong> across all link-operator mutated models.</p>
</div>
<p>We will use several statistical methods, in each of the sub-sections below.</p>
<div class="orange-box">
<p>The training data is a <strong>link-operator matrix</strong>, where rows are models (<span class="math inline">\(2^{23}\)</span>), columns/features/variables are link-operator nodes (<span class="math inline">\(23\)</span> in total) and the parameterization values correspond to <span class="math inline">\(0\)</span> (<code>AND-NOT</code>) or <span class="math inline">\(1\)</span> (<code>OR-NOT</code>).
The ternary response for each model is a number denoting the number of fixpoints (<span class="math inline">\(0,1\)</span> or <span class="math inline">\(2\)</span>).</p>
</div>
<p>The matrix we can generate with the script <a href="https://github.com/bblodfon/balance-paper/blob/master/scripts/get_lo_mat.R">get_lo_mat.R</a> and the response is part of the previously generated data from the script <a href="https://github.com/bblodfon/balance-paper/blob/master/scripts/count_model_ss.R">count_model_ss.R</a>.</p>
<div id="glmnet" class="section level3 unnumbered" number="">
<h3>Glmnet</h3>
<p>Use the script <a href="https://github.com/bblodfon/balance-paper/blob/master/scripts/param_ss_glmnet.R">param_ss_glmnet.R</a> to fit a <strong>multinomial LASSO model</strong> for the data <span class="citation">(Friedman, Hastie, and Tibshirani <a href="references.html#ref-Friedman2010" role="doc-biblioref">2010</a>)</span>.
We now simply load the result object:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="cascade-1-0-analysis-all-models.html#cb21-1"></a>fit_a1 =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/fit_a1.rds&quot;</span>)</span>
<span id="cb21-2"><a href="cascade-1-0-analysis-all-models.html#cb21-2"></a><span class="kw">plot</span>(fit_a1, <span class="dt">xvar =</span> <span class="st">&quot;dev&quot;</span>, <span class="dt">type.coef =</span> <span class="st">&quot;2norm&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/param-ss-glmnet-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="cascade-1-0-analysis-all-models.html#cb22-1"></a><span class="kw">plot</span>(fit_a1, <span class="dt">xvar =</span> <span class="st">&quot;lambda&quot;</span>, <span class="dt">type.coef =</span> <span class="st">&quot;2norm&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/param-ss-glmnet-2.png" width="672" /></p>
<p>As we can see there is no <span class="math inline">\(\lambda\)</span> that could explain more than <span class="math inline">\(44\%\)</span> of the deviance and there are a lot of non-zero coefficients associated with smaller values of <span class="math inline">\(\lambda\)</span>.
For example, choosing <span class="math inline">\(\lambda = 0.0142\)</span> (tested prediction accuracy <span class="math inline">\(\approx 0.72\)</span> on a random subset of the data), we have the following coefficients, shown in a heatmap:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="cascade-1-0-analysis-all-models.html#cb23-1"></a><span class="co"># choose a lambda</span></span>
<span id="cb23-2"><a href="cascade-1-0-analysis-all-models.html#cb23-2"></a>lambda1 =<span class="st"> </span>fit_a1<span class="op">$</span>lambda[<span class="dv">32</span>]</span>
<span id="cb23-3"><a href="cascade-1-0-analysis-all-models.html#cb23-3"></a></span>
<span id="cb23-4"><a href="cascade-1-0-analysis-all-models.html#cb23-4"></a>fit_a1_coef =<span class="st"> </span><span class="kw">coef</span>(fit_a1, <span class="dt">s =</span> lambda1) <span class="op">%&gt;%</span></span>
<span id="cb23-5"><a href="cascade-1-0-analysis-all-models.html#cb23-5"></a><span class="st">  </span><span class="kw">lapply</span>(as.matrix) <span class="op">%&gt;%</span></span>
<span id="cb23-6"><a href="cascade-1-0-analysis-all-models.html#cb23-6"></a><span class="st">  </span><span class="kw">Reduce</span>(cbind, <span class="dt">x =</span> .) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">t</span>()</span>
<span id="cb23-7"><a href="cascade-1-0-analysis-all-models.html#cb23-7"></a><span class="kw">rownames</span>(fit_a1_coef) =<span class="st"> </span><span class="kw">names</span>(<span class="kw">coef</span>(fit_a1, <span class="dt">s =</span> lambda1)) <span class="co"># 0, 1 and 2 stable states</span></span>
<span id="cb23-8"><a href="cascade-1-0-analysis-all-models.html#cb23-8"></a></span>
<span id="cb23-9"><a href="cascade-1-0-analysis-all-models.html#cb23-9"></a>imp_nodes_colors =<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="kw">length</span>(<span class="kw">colnames</span>(fit_a1_coef)))</span>
<span id="cb23-10"><a href="cascade-1-0-analysis-all-models.html#cb23-10"></a><span class="kw">names</span>(imp_nodes_colors) =<span class="st"> </span><span class="kw">colnames</span>(fit_a1_coef)</span>
<span id="cb23-11"><a href="cascade-1-0-analysis-all-models.html#cb23-11"></a>imp_nodes_colors[<span class="kw">names</span>(imp_nodes_colors) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;MEK_f&quot;</span>, <span class="st">&quot;PTEN&quot;</span>, <span class="st">&quot;MAPK14&quot;</span>)] =<span class="st"> &quot;green4&quot;</span></span>
<span id="cb23-12"><a href="cascade-1-0-analysis-all-models.html#cb23-12"></a></span>
<span id="cb23-13"><a href="cascade-1-0-analysis-all-models.html#cb23-13"></a>ComplexHeatmap<span class="op">::</span><span class="kw">Heatmap</span>(<span class="dt">matrix =</span> fit_a1_coef, <span class="dt">name =</span> <span class="st">&quot;Coef&quot;</span>, <span class="dt">row_title =</span> <span class="st">&quot;Number of Fixpoints&quot;</span>, </span>
<span id="cb23-14"><a href="cascade-1-0-analysis-all-models.html#cb23-14"></a>  <span class="dt">row_names_side =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">row_dend_side =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">row_title_side =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb23-15"><a href="cascade-1-0-analysis-all-models.html#cb23-15"></a>  <span class="dt">column_title =</span> <span class="st">&quot;Glmnet Coefficient Scores (Î» = 0.0142)&quot;</span>,</span>
<span id="cb23-16"><a href="cascade-1-0-analysis-all-models.html#cb23-16"></a>  <span class="dt">column_dend_height =</span> <span class="kw">unit</span>(<span class="dv">20</span>, <span class="st">&quot;mm&quot;</span>), <span class="dt">column_names_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> imp_nodes_colors))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:param-ss-glmnet-2"></span>
<img src="index_files/figure-html/param-ss-glmnet-2-1.png" alt="Heatmap of coefficients of multinomial model (glmnet)" width="2100" />
<p class="caption">
Figure 11: Heatmap of coefficients of multinomial model (glmnet)
</p>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="cascade-1-0-analysis-all-models.html#cb24-1"></a><span class="co"># check accuracy</span></span>
<span id="cb24-2"><a href="cascade-1-0-analysis-all-models.html#cb24-2"></a><span class="co"># lo_mat = readRDS(file = &quot;data/lo_mat.rds&quot;)</span></span>
<span id="cb24-3"><a href="cascade-1-0-analysis-all-models.html#cb24-3"></a><span class="co"># models_ss_stats = readRDS(file = &quot;data/models_ss_stats.rds&quot;)</span></span>
<span id="cb24-4"><a href="cascade-1-0-analysis-all-models.html#cb24-4"></a><span class="co"># ss_num = models_ss_stats %&gt;% pull(ss_num)</span></span>
<span id="cb24-5"><a href="cascade-1-0-analysis-all-models.html#cb24-5"></a><span class="co"># set.seed(42)</span></span>
<span id="cb24-6"><a href="cascade-1-0-analysis-all-models.html#cb24-6"></a><span class="co"># model_indexes = sample(x = 1:nrow(lo_mat), size = 100000)</span></span>
<span id="cb24-7"><a href="cascade-1-0-analysis-all-models.html#cb24-7"></a><span class="co"># pred = predict(object = fit_a1, newx = lo_mat[model_indexes, ],</span></span>
<span id="cb24-8"><a href="cascade-1-0-analysis-all-models.html#cb24-8"></a><span class="co">#   type = &quot;class&quot;, s = lambda1) %&gt;% as.integer()</span></span>
<span id="cb24-9"><a href="cascade-1-0-analysis-all-models.html#cb24-9"></a><span class="co"># acc = sum(pred == ss_num[model_indexes])/length(pred)</span></span>
<span id="cb24-10"><a href="cascade-1-0-analysis-all-models.html#cb24-10"></a><span class="co"># print(acc) # should be ~ 0.72</span></span></code></pre></div>
<div class="green-box">
<p>Even thought the <em>glmnet</em> classifier might not be accurate enough, we still find that the nodes <code>PTEN</code> and <code>MAPK14</code> are the <strong>most important (larger coefficients)</strong> for distinguishing between the models with different number of fixpoints.
Additional nodes (like <code>MEK_f</code> and <code>CTNNB1</code>) are likely to be importane as well.</p>
</div>
<p>If we cross-validate the regularization parameter <span class="math inline">\(\lambda\)</span> (using the same script, we randomly selected smaller model samples - <span class="math inline">\(100000\)</span>, <span class="math inline">\(20\)</span> times in total), and choose the <span class="math inline">\(\lambda_{1se}\)</span> for each different run to get the coefficients, the results can be visualized as follows:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="cascade-1-0-analysis-all-models.html#cb25-1"></a>cvfit_data =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/cvfit_data.rds&quot;</span>)</span>
<span id="cb25-2"><a href="cascade-1-0-analysis-all-models.html#cb25-2"></a>cvfit_mat_list =<span class="st"> </span><span class="kw">lapply</span>(cvfit_data, <span class="cf">function</span>(cvfit) {</span>
<span id="cb25-3"><a href="cascade-1-0-analysis-all-models.html#cb25-3"></a>  co =<span class="st"> </span><span class="kw">coef</span>(cvfit) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-4"><a href="cascade-1-0-analysis-all-models.html#cb25-4"></a><span class="st">    </span><span class="kw">lapply</span>(as.matrix) <span class="op">%&gt;%</span></span>
<span id="cb25-5"><a href="cascade-1-0-analysis-all-models.html#cb25-5"></a><span class="st">    </span><span class="kw">Reduce</span>(cbind, <span class="dt">x =</span> .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-6"><a href="cascade-1-0-analysis-all-models.html#cb25-6"></a><span class="st">    </span><span class="kw">t</span>()</span>
<span id="cb25-7"><a href="cascade-1-0-analysis-all-models.html#cb25-7"></a>  <span class="kw">rownames</span>(co) =<span class="st"> </span><span class="kw">names</span>(<span class="kw">coef</span>(cvfit)) <span class="co"># 0,1 and 2 stable states</span></span>
<span id="cb25-8"><a href="cascade-1-0-analysis-all-models.html#cb25-8"></a>  <span class="kw">return</span>(co)</span>
<span id="cb25-9"><a href="cascade-1-0-analysis-all-models.html#cb25-9"></a>})</span>
<span id="cb25-10"><a href="cascade-1-0-analysis-all-models.html#cb25-10"></a></span>
<span id="cb25-11"><a href="cascade-1-0-analysis-all-models.html#cb25-11"></a>cvfit_mat =<span class="st"> </span><span class="kw">do.call</span>(rbind, cvfit_mat_list)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="cascade-1-0-analysis-all-models.html#cb26-1"></a>imp_nodes_colors =<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="kw">length</span>(<span class="kw">colnames</span>(cvfit_mat)))</span>
<span id="cb26-2"><a href="cascade-1-0-analysis-all-models.html#cb26-2"></a><span class="kw">names</span>(imp_nodes_colors) =<span class="st"> </span><span class="kw">colnames</span>(cvfit_mat)</span>
<span id="cb26-3"><a href="cascade-1-0-analysis-all-models.html#cb26-3"></a>imp_nodes_colors[<span class="kw">names</span>(imp_nodes_colors) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;MEK_f&quot;</span>, <span class="st">&quot;PTEN&quot;</span>, <span class="st">&quot;MAPK14&quot;</span>, <span class="st">&quot;CTNNB1&quot;</span>, <span class="st">&quot;mTORC1_c&quot;</span>)] =<span class="st"> &quot;green4&quot;</span></span>
<span id="cb26-4"><a href="cascade-1-0-analysis-all-models.html#cb26-4"></a></span>
<span id="cb26-5"><a href="cascade-1-0-analysis-all-models.html#cb26-5"></a>ComplexHeatmap<span class="op">::</span><span class="kw">Heatmap</span>(<span class="dt">matrix =</span> cvfit_mat, <span class="dt">name =</span> <span class="st">&quot;Coef&quot;</span>, <span class="dt">row_title =</span> <span class="st">&quot;Number of Fixpoints&quot;</span>, </span>
<span id="cb26-6"><a href="cascade-1-0-analysis-all-models.html#cb26-6"></a>  <span class="dt">row_dend_side =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">row_title_side =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb26-7"><a href="cascade-1-0-analysis-all-models.html#cb26-7"></a>  <span class="dt">column_title =</span> <span class="st">&quot;Glmnet Coefficient Scores&quot;</span>, <span class="dt">row_km =</span> <span class="dv">3</span>, <span class="dt">row_km_repeats =</span> <span class="dv">10</span>, </span>
<span id="cb26-8"><a href="cascade-1-0-analysis-all-models.html#cb26-8"></a>  <span class="dt">show_row_names =</span> <span class="ot">FALSE</span>, <span class="dt">column_dend_height =</span> <span class="kw">unit</span>(<span class="dv">20</span>, <span class="st">&quot;mm&quot;</span>),</span>
<span id="cb26-9"><a href="cascade-1-0-analysis-all-models.html#cb26-9"></a>  <span class="dt">column_names_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> imp_nodes_colors),</span>
<span id="cb26-10"><a href="cascade-1-0-analysis-all-models.html#cb26-10"></a>  <span class="dt">left_annotation =</span> <span class="kw">rowAnnotation</span>(<span class="dt">foo =</span> <span class="kw">anno_block</span>(</span>
<span id="cb26-11"><a href="cascade-1-0-analysis-all-models.html#cb26-11"></a>    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>), <span class="co"># with `show_row_names = TRUE` you can check this</span></span>
<span id="cb26-12"><a href="cascade-1-0-analysis-all-models.html#cb26-12"></a>    <span class="dt">labels_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fontsize =</span> <span class="dv">12</span>))))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:param-ss-glmnet-cv-fig"></span>
<img src="index_files/figure-html/param-ss-glmnet-cv-fig-1.png" alt="Heatmap of coefficients of multinomial model (glmnet - 20 CV models)" width="2100" />
<p class="caption">
Figure 12: Heatmap of coefficients of multinomial model (glmnet - 20 CV models)
</p>
</div>
<div class="green-box">
<p>The top 5 most important nodes are seen in green in the above heatmap: <code>MAPK14</code>, <code>PTEN</code>, <code>CTNNB1</code>, <code>MEK_f</code> and <code>mTORC1_c</code>.</p>
</div>
</div>
<div id="random-forest" class="section level3 unnumbered" number="">
<h3>Random Forest</h3>
<p>We used the <a href="https://github.com/bblodfon/balance-paper/blob/master/scripts/param_ss_randf.R">param_ss_randf.R</a> script to tune and train a random forest classifier on the dataset <span class="citation">(Liaw and Wiener <a href="references.html#ref-Liaw2002" role="doc-biblioref">2002</a>)</span>.
First we tuned the <code>mtry</code> parameter, the number of variables randomly selected at each tree split:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="cascade-1-0-analysis-all-models.html#cb27-1"></a>mtry_data =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/mtry_data.rds&quot;</span>)</span>
<span id="cb27-2"><a href="cascade-1-0-analysis-all-models.html#cb27-2"></a></span>
<span id="cb27-3"><a href="cascade-1-0-analysis-all-models.html#cb27-3"></a>mtry_data <span class="op">%&gt;%</span></span>
<span id="cb27-4"><a href="cascade-1-0-analysis-all-models.html#cb27-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> mtry, <span class="dt">y =</span> OOBError, <span class="dt">group =</span> mtry)) <span class="op">+</span></span>
<span id="cb27-5"><a href="cascade-1-0-analysis-all-models.html#cb27-5"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">fill =</span> <span class="st">&quot;green4&quot;</span>) <span class="op">+</span></span>
<span id="cb27-6"><a href="cascade-1-0-analysis-all-models.html#cb27-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Tuning Random Forest mtry parameter&quot;</span>) <span class="op">+</span></span>
<span id="cb27-7"><a href="cascade-1-0-analysis-all-models.html#cb27-7"></a><span class="st">  </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:param-ss-rf-mtry"></span>
<img src="index_files/figure-html/param-ss-rf-mtry-1.png" alt="Random Forest Tuning (mtry)" width="2100" />
<p class="caption">
Figure 13: Random Forest Tuning (mtry)
</p>
</div>
<div class="green-box">
<p>A value between <span class="math inline">\(14-18\)</span> for <code>mtry</code> seems to minimize the Out-Of-Bag Error, so we choose <span class="math inline">\(16\)</span> for the rest of the analysis.
For the number of trees parameter, we stayed with the default value (<span class="math inline">\(500\)</span>) as we observed that they were more than enough after a few test runs.</p>
</div>
<p>Next, we randomly selected <span class="math inline">\(100000\)</span> models from the dataset - a total of <span class="math inline">\(20\)</span> times - to train the random forest classifier and find the <strong>importance score of each node</strong>.
We load the result data and tidy up a bit:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="cascade-1-0-analysis-all-models.html#cb28-1"></a>rf_imp_data =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/rf_imp_data.rds&quot;</span>)</span>
<span id="cb28-2"><a href="cascade-1-0-analysis-all-models.html#cb28-2"></a></span>
<span id="cb28-3"><a href="cascade-1-0-analysis-all-models.html#cb28-3"></a><span class="co"># make a list of tibbles</span></span>
<span id="cb28-4"><a href="cascade-1-0-analysis-all-models.html#cb28-4"></a>tbl_list =<span class="st"> </span><span class="kw">lapply</span>(rf_imp_data, <span class="cf">function</span>(mat) {</span>
<span id="cb28-5"><a href="cascade-1-0-analysis-all-models.html#cb28-5"></a>  nodes =<span class="st"> </span><span class="kw">rownames</span>(mat)</span>
<span id="cb28-6"><a href="cascade-1-0-analysis-all-models.html#cb28-6"></a>  tibble<span class="op">::</span><span class="kw">as_tibble</span>(mat) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">nodes =</span> nodes)</span>
<span id="cb28-7"><a href="cascade-1-0-analysis-all-models.html#cb28-7"></a>})</span>
<span id="cb28-8"><a href="cascade-1-0-analysis-all-models.html#cb28-8"></a></span>
<span id="cb28-9"><a href="cascade-1-0-analysis-all-models.html#cb28-9"></a><span class="co"># OneForAll</span></span>
<span id="cb28-10"><a href="cascade-1-0-analysis-all-models.html#cb28-10"></a>imp_res =<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(tbl_list)</span>
<span id="cb28-11"><a href="cascade-1-0-analysis-all-models.html#cb28-11"></a></span>
<span id="cb28-12"><a href="cascade-1-0-analysis-all-models.html#cb28-12"></a><span class="co"># Get the importance stats</span></span>
<span id="cb28-13"><a href="cascade-1-0-analysis-all-models.html#cb28-13"></a>imp_stats =<span class="st"> </span>imp_res <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-14"><a href="cascade-1-0-analysis-all-models.html#cb28-14"></a><span class="st">  </span><span class="kw">group_by</span>(nodes) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-15"><a href="cascade-1-0-analysis-all-models.html#cb28-15"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_acc  =</span> <span class="kw">mean</span>(MeanDecreaseAccuracy), </span>
<span id="cb28-16"><a href="cascade-1-0-analysis-all-models.html#cb28-16"></a>            <span class="dt">sd_acc    =</span> <span class="kw">sd</span>(MeanDecreaseAccuracy), </span>
<span id="cb28-17"><a href="cascade-1-0-analysis-all-models.html#cb28-17"></a>            <span class="dt">mean_gini =</span> <span class="kw">mean</span>(MeanDecreaseGini), </span>
<span id="cb28-18"><a href="cascade-1-0-analysis-all-models.html#cb28-18"></a>            <span class="dt">sd_gini   =</span> <span class="kw">sd</span>(MeanDecreaseGini), </span>
<span id="cb28-19"><a href="cascade-1-0-analysis-all-models.html#cb28-19"></a>            <span class="dt">.groups =</span> <span class="st">&#39;keep&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-20"><a href="cascade-1-0-analysis-all-models.html#cb28-20"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<p>The importance scores for each node were the <strong>mean decrease in accuracy and node impurity</strong> (Gini Index).
We calculate the mean importance and standard deviation scores across all random samples for both measures of importance:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="cascade-1-0-analysis-all-models.html#cb29-1"></a><span class="co"># color first 5 nodes in x axis</span></span>
<span id="cb29-2"><a href="cascade-1-0-analysis-all-models.html#cb29-2"></a>imp_col =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;green4&quot;</span>, <span class="dv">5</span>), <span class="kw">rep</span>(<span class="st">&quot;grey30&quot;</span>, <span class="kw">nrow</span>(imp_stats)<span class="op">-</span><span class="dv">5</span>))</span>
<span id="cb29-3"><a href="cascade-1-0-analysis-all-models.html#cb29-3"></a>imp_stats <span class="op">%&gt;%</span></span>
<span id="cb29-4"><a href="cascade-1-0-analysis-all-models.html#cb29-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">nodes =</span> forcats<span class="op">::</span><span class="kw">fct_reorder</span>(nodes, <span class="kw">desc</span>(mean_acc))) <span class="op">%&gt;%</span></span>
<span id="cb29-5"><a href="cascade-1-0-analysis-all-models.html#cb29-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> nodes, <span class="dt">y =</span> mean_acc, <span class="dt">fill =</span> mean_acc)) <span class="op">+</span></span>
<span id="cb29-6"><a href="cascade-1-0-analysis-all-models.html#cb29-6"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb29-7"><a href="cascade-1-0-analysis-all-models.html#cb29-7"></a><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb29-8"><a href="cascade-1-0-analysis-all-models.html#cb29-8"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>mean_acc<span class="op">-</span>sd_acc, <span class="dt">ymax=</span>mean_acc<span class="op">+</span>sd_acc), <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb29-9"><a href="cascade-1-0-analysis-all-models.html#cb29-9"></a><span class="st">  </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-10"><a href="cascade-1-0-analysis-all-models.html#cb29-10"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">colour =</span> imp_col)) <span class="op">+</span></span>
<span id="cb29-11"><a href="cascade-1-0-analysis-all-models.html#cb29-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Random Forest Variable Importance (Accuracy)&quot;</span>, </span>
<span id="cb29-12"><a href="cascade-1-0-analysis-all-models.html#cb29-12"></a>    <span class="dt">x =</span> <span class="st">&quot;Nodes&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Mean Decrease Accuracy&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:param-ss-rf-imp-fig"></span>
<img src="index_files/figure-html/param-ss-rf-imp-fig-1.png" alt="Random Forest: Mean Decrease Accuracy per node" width="2100" />
<p class="caption">
Figure 14: Random Forest: Mean Decrease Accuracy per node
</p>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="cascade-1-0-analysis-all-models.html#cb30-1"></a>imp_stats <span class="op">%&gt;%</span></span>
<span id="cb30-2"><a href="cascade-1-0-analysis-all-models.html#cb30-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">nodes =</span> forcats<span class="op">::</span><span class="kw">fct_reorder</span>(nodes, <span class="kw">desc</span>(mean_gini))) <span class="op">%&gt;%</span></span>
<span id="cb30-3"><a href="cascade-1-0-analysis-all-models.html#cb30-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> nodes, <span class="dt">y =</span> mean_gini, <span class="dt">fill =</span> mean_gini)) <span class="op">+</span></span>
<span id="cb30-4"><a href="cascade-1-0-analysis-all-models.html#cb30-4"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb30-5"><a href="cascade-1-0-analysis-all-models.html#cb30-5"></a><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb30-6"><a href="cascade-1-0-analysis-all-models.html#cb30-6"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean_gini<span class="op">-</span>sd_gini, <span class="dt">ymax =</span> mean_gini<span class="op">+</span>sd_gini), <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb30-7"><a href="cascade-1-0-analysis-all-models.html#cb30-7"></a><span class="st">  </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-8"><a href="cascade-1-0-analysis-all-models.html#cb30-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">colour =</span> imp_col)) <span class="op">+</span></span>
<span id="cb30-9"><a href="cascade-1-0-analysis-all-models.html#cb30-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Random Forest Variable Importance (Gini Index)&quot;</span>, </span>
<span id="cb30-10"><a href="cascade-1-0-analysis-all-models.html#cb30-10"></a>    <span class="dt">x =</span> <span class="st">&quot;Nodes&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Mean Decrease in Node Impurity&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:param-ss-rf-imp-fig2"></span>
<img src="index_files/figure-html/param-ss-rf-imp-fig2-1.png" alt="Random Forest: Mean Node Impurity (Gini Index)" width="2100" />
<p class="caption">
Figure 15: Random Forest: Mean Node Impurity (Gini Index)
</p>
</div>
<div class="green-box">
<p>The top 5 important nodes by any of the two importance measures using Random Forests, include the nodes found as important with the LASSO method: <code>MAPK14</code>, <code>ERK_f</code>, <code>MEK_f</code>, <code>PTEN</code>, <code>mTORC1_c</code>.</p>
</div>
<p>Same results we get when using a faster, more memory efficient and with multi-thread support, random forest R package, namely <code>ranger</code> <span class="citation">(Wright and Ziegler <a href="references.html#ref-Wright2017" role="doc-biblioref">2017</a>)</span>.
Use the script <a href="https://github.com/bblodfon/balance-paper/blob/master/scripts/param_ss_ranger.R">param_ss_ranger.R</a> to reproduce the results (<span class="math inline">\(4000000\)</span> - almost half of the models are used for training and the importance measure calculated was the Gini index):</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="cascade-1-0-analysis-all-models.html#cb31-1"></a>ranger_res =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;data/ranger_res.rds&quot;</span>)</span>
<span id="cb31-2"><a href="cascade-1-0-analysis-all-models.html#cb31-2"></a>imp_res =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">nodes =</span> <span class="kw">names</span>(ranger_res<span class="op">$</span>variable.importance), </span>
<span id="cb31-3"><a href="cascade-1-0-analysis-all-models.html#cb31-3"></a>  <span class="dt">gini_index =</span> ranger_res<span class="op">$</span>variable.importance)</span>
<span id="cb31-4"><a href="cascade-1-0-analysis-all-models.html#cb31-4"></a></span>
<span id="cb31-5"><a href="cascade-1-0-analysis-all-models.html#cb31-5"></a>imp_res <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-6"><a href="cascade-1-0-analysis-all-models.html#cb31-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">nodes =</span> forcats<span class="op">::</span><span class="kw">fct_reorder</span>(nodes, <span class="kw">desc</span>(gini_index))) <span class="op">%&gt;%</span></span>
<span id="cb31-7"><a href="cascade-1-0-analysis-all-models.html#cb31-7"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> nodes, <span class="dt">y =</span> gini_index, <span class="dt">fill =</span> gini_index)) <span class="op">+</span></span>
<span id="cb31-8"><a href="cascade-1-0-analysis-all-models.html#cb31-8"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb31-9"><a href="cascade-1-0-analysis-all-models.html#cb31-9"></a><span class="st">    </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb31-10"><a href="cascade-1-0-analysis-all-models.html#cb31-10"></a><span class="st">    </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-11"><a href="cascade-1-0-analysis-all-models.html#cb31-11"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">colour =</span> imp_col)) <span class="op">+</span></span>
<span id="cb31-12"><a href="cascade-1-0-analysis-all-models.html#cb31-12"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Random Forest (Ranger) Variable Importance (Gini Index)&quot;</span>, </span>
<span id="cb31-13"><a href="cascade-1-0-analysis-all-models.html#cb31-13"></a>      <span class="dt">x =</span> <span class="st">&quot;Nodes&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Mean Decrease in Node Impurity&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:param-ss-rf-imp-fig3"></span>
<img src="index_files/figure-html/param-ss-rf-imp-fig3-1.png" alt="Random Forest (ranger): Mean Node Impurity (Gini Index)" width="2100" />
<p class="caption">
Figure 16: Random Forest (ranger): Mean Node Impurity (Gini Index)
</p>
</div>
</div>
<div id="parameterization-map" class="section level3 unnumbered" number="">
<h3>Parameterization Map</h3>
<p>We use UMAP <span class="citation">(McInnes, Healy, and Melville <a href="references.html#ref-McInnes2018a" role="doc-biblioref">2018</a>)</span> to <strong>reduce the dimensionality of our dataset</strong> from <span class="math inline">\(23\)</span> (number of nodes with link operators) to <span class="math inline">\(2\)</span> and visualize it to see if there is any apparent <em>visual relation</em> between the models parameterization and number of fixpoints.
Note that because of memory restrictions (we had a total of 16GB available) we couldnât run UMAP on the whole dataset.</p>
<p>We used the <a href="https://github.com/bblodfon/balance-paper/blob/master/scripts/param_ss_umap.R">param_ss_umap.R</a> script to run the UMAP implementation offered by the <code>uwot</code> R package.
We make the plots afterwards using the result data with the <a href="https://github.com/bblodfon/balance-paper/blob/master/scripts/param_ss_umap_vis.R">param_ss_umap_vis.R</a> script.</p>
<div id="unsupervised-umap" class="section level4 unnumbered" number="">
<h4>Unsupervised UMAP</h4>
<p>First, we randomly choose a subset of our dataset (<span class="math inline">\(6000000\)</span> rows, so <span class="math inline">\(\approx 71\%\)</span> of the link operator models) and applied <strong>unsupervised UMAP</strong> (no <em>a priori</em> knowledge of the number of fixpoints per model provided or of any other information/label per model for that matter).</p>
<p>UMAP is given a subset of all binary numbers from <span class="math inline">\(0\)</span> (<span class="math inline">\(23\)</span> <span class="math inline">\(0\)</span>âs) to <span class="math inline">\(2^{23}-1\)</span> (<span class="math inline">\(23\)</span> <span class="math inline">\(1\)</span>âs) representing each possible link operator mutated model (<span class="math inline">\(0\)</span>âs map to <code>AND-NOT</code>, <span class="math inline">\(1\)</span>âs to <code>OR-NOT</code>) and places them in the 2D plane.
The following figure show us the models, <strong>colored by their decimal (base-10) number</strong> (converted from the binary link-operator model representation):</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="cascade-1-0-analysis-all-models.html#cb32-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/umap_unsupervised_model_num.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:umap-unsup-model-num-fig"></span>
<img src="img/umap_unsupervised_model_num.png" alt="UMAP: Parameterization vs Numerical Model Representation" width="1050" />
<p class="caption">
Figure 17: UMAP: Parameterization vs Numerical Model Representation
</p>
</div>
<div class="green-box">
<p>UMAP has found <strong>neighboorhoods of similarly parameterized models</strong>.</p>
<p>We used the <em>manhattan</em> distance metric in the UMAP algorithm and as such, a model number that can be more than a thousands of numbers away on the decimal system from another model number, might actually be very close to it if we check the corresponding distance of their binary representations (e.g.Â the manhattan distance between <span class="math inline">\(000...00_2=0\)</span> <span class="math inline">\(100...00_2=2^{22}=4194304\)</span> is 1).</p>
</div>
<p>Same models, same 2D placement, only now colored by their number of fixpoints:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="cascade-1-0-analysis-all-models.html#cb33-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/umap_unsupervised.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:umap-unsup-fig"></span>
<img src="img/umap_unsupervised.png" alt="UMAP: Parameterization vs Number of fixpoints" width="1050" />
<p class="caption">
Figure 18: UMAP: Parameterization vs Number of fixpoints
</p>
</div>
<div class="green-box">
<p>Models with <strong>similar parameterization seem to also have the same number of fixpoints</strong>.
We also notice specific subareas being completely covered by such same-structure, same-fixpoint-number models (<span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>-fixpoint model clusters) showing us that some parameterization families are eligible to the same attractor fate.</p>
<p>The <span class="math inline">\(2\)</span>-fixpoint models seem to always lie next to similarly parameterized <span class="math inline">\(1\)</span>-fixpoint models (they are like a subcategory of those and not like a separate one) and not in clusters of their own.
As such, they can be found cross all the areas of the parameterization map.</p>
</div>
</div>
<div id="supervised-umap" class="section level4 unnumbered" number="">
<h4>Supervised UMAP</h4>
<p>Next, we randomly choose <span class="math inline">\(1/3=33\%\)</span> of our dataset and applied <strong>UMAP in supervised mode</strong> (the association between each model and the corresponding fixpoint group was given as input to UMAP):</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="cascade-1-0-analysis-all-models.html#cb34-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/umap_supervised.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:umap-sup-fig"></span>
<img src="img/umap_supervised.png" alt="UMAP Supervised: Parameterization vs Number of fixpoints" width="1050" />
<p class="caption">
Figure 19: UMAP Supervised: Parameterization vs Number of fixpoints
</p>
</div>
<div class="green-box">
<p>We observe that the <span class="math inline">\(2\)</span>-fixpoint model structures are spread out in the Y dimension much less than the corresponding <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>-fixpoint models.</p>
<p>So, it seems that the more complex are the models (here we mean dynamical complexity - i.e.Â more attractors) the more spread out are in the parameterization map and form many more distinct clusters.</p>
</div>
<p>If we <strong>retain the above fixpoint-class 2D model placement</strong> and color it according to the models numerical representation, we can see the existence of small closely-parameterized clusters within each super-cluster as well as the fact that the models in each super-cluster are spread throughout the parameterization landscape:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="cascade-1-0-analysis-all-models.html#cb35-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/umap_supervised_model_num.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:umap-sup-fig-2"></span>
<img src="img/umap_supervised_model_num.png" alt="UMAP Supervised: Parameterization vs Numerical Model Representation" width="1050" />
<p class="caption">
Figure 20: UMAP Supervised: Parameterization vs Numerical Model Representation
</p>
</div>
</div>
</div>
<div id="embedding-important-nodes-in-the-map" class="section level3 unnumbered" number="">
<h3>Embedding Important Nodes in the Map</h3>
<p>Using random forest and regularized LASSO method, we found important nodes whose parameterization affects the change of dynamics (number of fixpoints).
Using (supervised) UMAP we took a sample of the dataset (<span class="math inline">\(33\%\)</span> of the models) and placed it to the 2D plane, linking closely parameterized models in clusters.</p>
<p>We will now color the <a href="cascade-1-0-analysis-all-models.html#supervised-umap">supervised UMAP-generated map</a> with the link-operator values of the top 5 most important nodes found from the aforementioned methods as well the least important node reported with random forests (use the <a href="https://github.com/bblodfon/balance-paper/blob/master/scripts/param_ss_umap_sup_imp_nodes.R">param_ss_umap_sup_imp_nodes.R</a> script).</p>
<p>The 3 most important nodes:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="cascade-1-0-analysis-all-models.html#cb36-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/umap_supervised_MAPK14.png&quot;</span>)</span></code></pre></div>
<p><img src="img/umap_supervised_MAPK14.png" width="1050" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="cascade-1-0-analysis-all-models.html#cb37-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/umap_supervised_MEK_f.png&quot;</span>)</span></code></pre></div>
<p><img src="img/umap_supervised_MEK_f.png" width="1050" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="cascade-1-0-analysis-all-models.html#cb38-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/umap_supervised_ERK_f.png&quot;</span>)</span></code></pre></div>
<p><img src="img/umap_supervised_ERK_f.png" width="1050" /></p>
<p>The next 2 most important nodes:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="cascade-1-0-analysis-all-models.html#cb39-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/umap_supervised_mTORC1_c.png&quot;</span>)</span></code></pre></div>
<p><img src="img/umap_supervised_mTORC1_c.png" width="1050" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="cascade-1-0-analysis-all-models.html#cb40-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/umap_supervised_PTEN.png&quot;</span>)</span></code></pre></div>
<p><img src="img/umap_supervised_PTEN.png" width="1050" /></p>
<p><strong><code>CFLAR</code></strong> was the least important node for assessing the number of fixpoints of a model from its parameterization:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="cascade-1-0-analysis-all-models.html#cb41-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;img/umap_supervised_CFLAR.png&quot;</span>)</span></code></pre></div>
<p><img src="img/umap_supervised_CFLAR.png" width="1050" /></p>
<div class="green-box">
<p>We can see a <strong>visual link</strong> between node importance (related to #fixpoints) and link operator assignment: the <em>less</em> important a node is, the more <em>randomly distributed</em> itâs link-operator values are across the parameterization map.</p>
<p>The important nodes can be used to more accurately define <strong>families of closely parameterized models</strong>.</p>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bbr-function-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cascade-1-0-analysis-1-ss-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
